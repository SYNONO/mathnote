# 2-6-1 分块矩阵的定义与运算

#数学二 #线性代数 #第二章 #矩阵 #分块矩阵 #矩阵分块

## 🏷️ 标签体系
- **L1知识点**：`分块矩阵定义` `分块矩阵运算` `分块矩阵转置` `分块矩阵乘法`
- **L2方法**：`矩阵分块技巧` `分块运算法则` `分块求逆`
- **L3章节**：`矩阵`
- **难度**：`medium`

## 📖 概述

分块矩阵是将矩阵按照某种方式分成若干个子矩阵（块）的方法。这种方法可以简化大型矩阵的运算，使矩阵的结构更加清晰，在理论研究和实际计算中都有重要应用。

## 一、分块矩阵的概念

### 📖 定义
将矩阵 $A$ 用若干条横线和竖线分成许多个小矩阵，每个小矩阵称为 $A$ 的一个子块，以子块为元素的形式上的矩阵称为分块矩阵。

### 📐 例题2.133
将下列矩阵进行分块：
$$A = \begin{pmatrix}
1 & 2 & 0 & 0 \\
3 & 4 & 0 & 0 \\
0 & 0 & 5 & 6 \\
0 & 0 & 7 & 8
\end{pmatrix}$$

**解**：
可以分块为：
$$A = \begin{pmatrix} A_{11} & A_{12} \\ A_{21} & A_{22} \end{pmatrix} = \begin{pmatrix} 
\begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix} & \begin{pmatrix} 0 & 0 \\ 0 & 0 \end{pmatrix} \\
\begin{pmatrix} 0 & 0 \\ 0 & 0 \end{pmatrix} & \begin{pmatrix} 5 & 6 \\ 7 & 8 \end{pmatrix}
\end{pmatrix}$$

简记为：$A = \begin{pmatrix} A_{11} & O \\ O & A_{22} \end{pmatrix}$

### 💡 分块的原则
1. 根据矩阵的结构特点分块
2. 使运算简化
3. 突出矩阵的特殊性质

## 二、分块矩阵的运算

### 1. 分块矩阵的加法

### 🔑 法则
若 $A$ 和 $B$ 是同型矩阵且采用相同的分块方式：
$$A = \begin{pmatrix} A_{ij} \end{pmatrix}, \quad B = \begin{pmatrix} B_{ij} \end{pmatrix}$$

则：
$$A + B = \begin{pmatrix} A_{ij} + B_{ij} \end{pmatrix}$$

### 📐 例题2.134
计算分块矩阵的和：
$$A = \begin{pmatrix} E_2 & O \\ O & E_2 \end{pmatrix}, \quad B = \begin{pmatrix} O & E_2 \\ E_2 & O \end{pmatrix}$$

**解**：
$$A + B = \begin{pmatrix} E_2 + O & O + E_2 \\ O + E_2 & E_2 + O \end{pmatrix} = \begin{pmatrix} E_2 & E_2 \\ E_2 & E_2 \end{pmatrix}$$

展开后：
$$A + B = \begin{pmatrix}
1 & 0 & 1 & 0 \\
0 & 1 & 0 & 1 \\
1 & 0 & 1 & 0 \\
0 & 1 & 0 & 1
\end{pmatrix}$$

### 2. 分块矩阵的数乘

### 🔑 法则
$$kA = k\begin{pmatrix} A_{ij} \end{pmatrix} = \begin{pmatrix} kA_{ij} \end{pmatrix}$$

### 3. 分块矩阵的转置

### 🔑 法则
$$A^T = \begin{pmatrix} A_{ij} \end{pmatrix}^T = \begin{pmatrix} A_{ji}^T \end{pmatrix}$$

注意：不仅要转置整体位置，还要转置每个子块。

### 📐 例题2.135
求分块矩阵的转置：
$$A = \begin{pmatrix} 
\begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix} & \begin{pmatrix} 5 \\ 6 \end{pmatrix} \\
\begin{pmatrix} 7 & 8 \end{pmatrix} & \begin{pmatrix} 9 \end{pmatrix}
\end{pmatrix}$$

**解**：
$$A^T = \begin{pmatrix}
\begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}^T & \begin{pmatrix} 7 & 8 \end{pmatrix}^T \\
\begin{pmatrix} 5 \\ 6 \end{pmatrix}^T & \begin{pmatrix} 9 \end{pmatrix}^T
\end{pmatrix} = \begin{pmatrix}
\begin{pmatrix} 1 & 3 \\ 2 & 4 \end{pmatrix} & \begin{pmatrix} 7 \\ 8 \end{pmatrix} \\
\begin{pmatrix} 5 & 6 \end{pmatrix} & \begin{pmatrix} 9 \end{pmatrix}
\end{pmatrix}$$

## 三、分块矩阵的乘法

### 🔑 法则
若 $A$ 的列的分块方式与 $B$ 的行的分块方式一致，则：
$$AB = \begin{pmatrix} A_{ik} \end{pmatrix}\begin{pmatrix} B_{kj} \end{pmatrix} = \begin{pmatrix} \sum_k A_{ik}B_{kj} \end{pmatrix}$$

### ⚠️ 注意
1. $A$ 的列分块数 = $B$ 的行分块数
2. 对应的子块必须可乘

### 📐 例题2.136
计算分块矩阵的乘积：
$$A = \begin{pmatrix} E & O \\ O & 2E \end{pmatrix}, \quad B = \begin{pmatrix} A_1 & A_2 \\ A_3 & A_4 \end{pmatrix}$$

其中 $E$ 是2阶单位矩阵，$A_1, A_2, A_3, A_4$ 都是 $2 \times 2$ 矩阵。

**解**：
$$AB = \begin{pmatrix} E & O \\ O & 2E \end{pmatrix}\begin{pmatrix} A_1 & A_2 \\ A_3 & A_4 \end{pmatrix} = \begin{pmatrix} EA_1 + OA_3 & EA_2 + OA_4 \\ OA_1 + 2EA_3 & OA_2 + 2EA_4 \end{pmatrix}$$

$$= \begin{pmatrix} A_1 & A_2 \\ 2A_3 & 2A_4 \end{pmatrix}$$

### 📐 例题2.137
利用分块计算矩阵乘积：
$$\begin{pmatrix}
1 & 0 & 2 & 0 \\
0 & 1 & 0 & 2 \\
0 & 0 & 3 & 0 \\
0 & 0 & 0 & 3
\end{pmatrix}\begin{pmatrix}
1 & 1 & 0 & 0 \\
2 & 2 & 0 & 0 \\
0 & 0 & 1 & 1 \\
0 & 0 & 3 & 3
\end{pmatrix}$$

**解**：
分块为：
$$A = \begin{pmatrix} E & 2E \\ O & 3E \end{pmatrix}, \quad B = \begin{pmatrix} \begin{pmatrix} 1 & 1 \\ 2 & 2 \end{pmatrix} & O \\ O & \begin{pmatrix} 1 & 1 \\ 3 & 3 \end{pmatrix} \end{pmatrix}$$

$$AB = \begin{pmatrix} 
E\begin{pmatrix} 1 & 1 \\ 2 & 2 \end{pmatrix} + 2E \cdot O & E \cdot O + 2E\begin{pmatrix} 1 & 1 \\ 3 & 3 \end{pmatrix} \\
O\begin{pmatrix} 1 & 1 \\ 2 & 2 \end{pmatrix} + 3E \cdot O & O \cdot O + 3E\begin{pmatrix} 1 & 1 \\ 3 & 3 \end{pmatrix}
\end{pmatrix}$$

$$= \begin{pmatrix}
\begin{pmatrix} 1 & 1 \\ 2 & 2 \end{pmatrix} & \begin{pmatrix} 2 & 2 \\ 6 & 6 \end{pmatrix} \\
O & \begin{pmatrix} 3 & 3 \\ 9 & 9 \end{pmatrix}
\end{pmatrix} = \begin{pmatrix}
1 & 1 & 2 & 2 \\
2 & 2 & 6 & 6 \\
0 & 0 & 3 & 3 \\
0 & 0 & 9 & 9
\end{pmatrix}$$

## 四、特殊分块矩阵

### 1. 对角分块矩阵

### 📖 定义
形如 $A = \begin{pmatrix} A_1 & & & \\ & A_2 & & \\ & & \ddots & \\ & & & A_n \end{pmatrix}$ 的矩阵称为对角分块矩阵。

### 🔑 性质
1. $A^k = \begin{pmatrix} A_1^k & & & \\ & A_2^k & & \\ & & \ddots & \\ & & & A_n^k \end{pmatrix}$

2. 若各 $A_i$ 都可逆，则 $A^{-1} = \begin{pmatrix} A_1^{-1} & & & \\ & A_2^{-1} & & \\ & & \ddots & \\ & & & A_n^{-1} \end{pmatrix}$

3. $|A| = |A_1| \cdot |A_2| \cdots |A_n|$（当 $A$ 是方阵时）

### 2. 上（下）三角分块矩阵

### 📐 例题2.138
设 $A = \begin{pmatrix} A_{11} & A_{12} \\ O & A_{22} \end{pmatrix}$，其中 $A_{11}$、$A_{22}$ 都是方阵且可逆，求 $A^{-1}$。

**解**：
设 $A^{-1} = \begin{pmatrix} B_{11} & B_{12} \\ B_{21} & B_{22} \end{pmatrix}$

由 $AA^{-1} = E$：
$$\begin{pmatrix} A_{11} & A_{12} \\ O & A_{22} \end{pmatrix}\begin{pmatrix} B_{11} & B_{12} \\ B_{21} & B_{22} \end{pmatrix} = \begin{pmatrix} E & O \\ O & E \end{pmatrix}$$

得到：
$$\begin{cases}
A_{11}B_{11} + A_{12}B_{21} = E \\
A_{11}B_{12} + A_{12}B_{22} = O \\
A_{22}B_{21} = O \\
A_{22}B_{22} = E
\end{cases}$$

解得：
- $B_{22} = A_{22}^{-1}$
- $B_{21} = O$（因为 $A_{22}$ 可逆）
- $B_{11} = A_{11}^{-1}$
- $B_{12} = -A_{11}^{-1}A_{12}A_{22}^{-1}$

所以：
$$A^{-1} = \begin{pmatrix} A_{11}^{-1} & -A_{11}^{-1}A_{12}A_{22}^{-1} \\ O & A_{22}^{-1} \end{pmatrix}$$

## 五、分块矩阵的行列式

### 🔑 重要公式

1. 对角分块：$\begin{vmatrix} A & O \\ O & B \end{vmatrix} = |A| \cdot |B|$

2. 反对角分块：$\begin{vmatrix} O & A \\ B & O \end{vmatrix} = (-1)^{mn}|A| \cdot |B|$（$A$ 是 $m$ 阶，$B$ 是 $n$ 阶）

3. 三角分块：$\begin{vmatrix} A & C \\ O & B \end{vmatrix} = |A| \cdot |B|$

### 📐 例题2.139
计算行列式：
$$\begin{vmatrix}
2 & 1 & 0 & 0 \\
3 & 4 & 0 & 0 \\
1 & 2 & 3 & 4 \\
5 & 6 & 7 & 8
\end{vmatrix}$$

**解**：
分块为 $\begin{vmatrix} A & O \\ C & B \end{vmatrix}$，其中：
$$A = \begin{pmatrix} 2 & 1 \\ 3 & 4 \end{pmatrix}, \quad B = \begin{pmatrix} 3 & 4 \\ 7 & 8 \end{pmatrix}$$

原行列式 = $|A| \cdot |B| = (8-3) \cdot (24-28) = 5 \cdot (-4) = -20$

## 六、分块技巧

### 💡 常用分块方式

1. **按行（列）分块**：将矩阵看作行（列）向量的组合
2. **按零元素分布分块**：充分利用零块简化运算
3. **按相同结构分块**：发现并利用重复的子结构
4. **按可逆子块分块**：便于求逆运算

### 📐 例题2.140
设 $A = \begin{pmatrix} a & b & b & \cdots & b \\ b & a & b & \cdots & b \\ b & b & a & \cdots & b \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ b & b & b & \cdots & a \end{pmatrix}_{n \times n}$，求 $|A|$。

**解**：
记 $J$ 为元素全为1的 $n \times n$ 矩阵，$e = (1,1,\cdots,1)^T$。

则 $A = (a-b)E + bJ = (a-b)E + be e^T$

利用行列式公式：$|E + uv^T| = 1 + v^Tu$（当 $u, v$ 是向量时）

$$|A| = |(a-b)(E + \frac{b}{a-b}ee^T)| = (a-b)^n|E + \frac{b}{a-b}ee^T|$$

$$= (a-b)^n(1 + \frac{b}{a-b}e^Te) = (a-b)^n(1 + \frac{nb}{a-b})$$

$$= (a-b)^n \cdot \frac{a-b+nb}{a-b} = (a-b)^{n-1}[a+(n-1)b]$$

## 🎯 易错提醒

1. **分块方式一致性**：
   - 加法要求完全相同的分块方式
   - 乘法要求列分块与行分块对应

2. **子块的可乘性**：
   - 对应子块的阶数必须满足可乘条件
   - 不是所有分块都能进行乘法

3. **转置运算**：
   - 既要转置位置，又要转置每个子块
   - 容易遗漏子块内部的转置

4. **行列式计算**：
   - 只有方阵才能计算行列式
   - 注意反对角情况的符号

## 🔗 相关链接

- [[2-6-2 分块矩阵的应用]]（应用实例）
- [[2-2-1 矩阵的加法与数乘]]（基本运算）
- [[2-2-2 矩阵的乘法]]（乘法运算）
- [[2-3-3 逆矩阵的计算方法]]（分块求逆）

## 🔗 相关题目练习
根据标签可在题库中搜索：
- 知识点标签：`分块矩阵定义` `分块矩阵运算` `分块矩阵乘法`
- 章节标签：`矩阵`
- 难度：`medium`

---
*学习提示：分块矩阵是处理大型矩阵的有力工具。关键是选择合适的分块方式，充分利用矩阵的结构特点。熟练掌握分块运算法则，特别是分块乘法和分块求逆，在解题中会带来很大便利。*