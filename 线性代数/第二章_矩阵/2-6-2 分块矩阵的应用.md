# 2-6-2 分块矩阵的应用

#数学二 #线性代数 #第二章 #矩阵 #分块矩阵应用 #矩阵方程

## 🏷️ 标签体系
- **L1知识点**：`分块求逆` `分块解方程` `分块求秩` `实际应用`
- **L2方法**：`分块技巧` `降阶法` `递推法` `分块证明`
- **L3章节**：`矩阵`
- **难度**：`hard`

## 📖 概述

分块矩阵不仅是一种表示方法，更是解决复杂矩阵问题的强大工具。本节将介绍分块矩阵在求逆、解方程、计算行列式、证明等方面的重要应用。

## 一、分块矩阵求逆

### 1. 对角分块矩阵的逆

### 📐 例题2.141
求矩阵的逆：
$$A = \begin{pmatrix}
2 & 3 & 0 & 0 \\
1 & 4 & 0 & 0 \\
0 & 0 & 1 & 2 \\
0 & 0 & 3 & 4
\end{pmatrix}$$

**解**：
分块为 $A = \begin{pmatrix} A_1 & O \\ O & A_2 \end{pmatrix}$，其中：
$$A_1 = \begin{pmatrix} 2 & 3 \\ 1 & 4 \end{pmatrix}, \quad A_2 = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}$$

分别求逆：
$$A_1^{-1} = \frac{1}{8-3}\begin{pmatrix} 4 & -3 \\ -1 & 2 \end{pmatrix} = \frac{1}{5}\begin{pmatrix} 4 & -3 \\ -1 & 2 \end{pmatrix}$$

$$A_2^{-1} = \frac{1}{4-6}\begin{pmatrix} 4 & -2 \\ -3 & 1 \end{pmatrix} = \begin{pmatrix} -2 & 1 \\ \frac{3}{2} & -\frac{1}{2} \end{pmatrix}$$

所以：
$$A^{-1} = \begin{pmatrix} A_1^{-1} & O \\ O & A_2^{-1} \end{pmatrix} = \begin{pmatrix}
\frac{4}{5} & -\frac{3}{5} & 0 & 0 \\
-\frac{1}{5} & \frac{2}{5} & 0 & 0 \\
0 & 0 & -2 & 1 \\
0 & 0 & \frac{3}{2} & -\frac{1}{2}
\end{pmatrix}$$

### 2. 一般2×2分块矩阵的逆

### 🔑 公式
设 $M = \begin{pmatrix} A & B \\ C & D \end{pmatrix}$，其中 $A$ 可逆，则：
$$M^{-1} = \begin{pmatrix} 
(A - BD^{-1}C)^{-1} & -A^{-1}B(D - CA^{-1}B)^{-1} \\
-D^{-1}C(A - BD^{-1}C)^{-1} & (D - CA^{-1}B)^{-1}
\end{pmatrix}$$

前提：$D - CA^{-1}B$ 可逆（称为Schur补）。

### 📐 例题2.142
用分块法求矩阵的逆：
$$M = \begin{pmatrix}
1 & 0 & 2 & 1 \\
0 & 1 & 1 & 2 \\
0 & 0 & 3 & 1 \\
0 & 0 & 2 & 4
\end{pmatrix}$$

**解**：
分块为 $M = \begin{pmatrix} E & B \\ O & D \end{pmatrix}$，其中：
$$B = \begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix}, \quad D = \begin{pmatrix} 3 & 1 \\ 2 & 4 \end{pmatrix}$$

由于是上三角分块，有：
$$M^{-1} = \begin{pmatrix} E^{-1} & -E^{-1}BD^{-1} \\ O & D^{-1} \end{pmatrix} = \begin{pmatrix} E & -BD^{-1} \\ O & D^{-1} \end{pmatrix}$$

计算 $D^{-1} = \frac{1}{10}\begin{pmatrix} 4 & -1 \\ -2 & 3 \end{pmatrix}$

$$BD^{-1} = \begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix} \cdot \frac{1}{10}\begin{pmatrix} 4 & -1 \\ -2 & 3 \end{pmatrix} = \frac{1}{10}\begin{pmatrix} 6 & 1 \\ 0 & 5 \end{pmatrix}$$

所以：
$$M^{-1} = \begin{pmatrix}
1 & 0 & -\frac{3}{5} & -\frac{1}{10} \\
0 & 1 & 0 & -\frac{1}{2} \\
0 & 0 & \frac{2}{5} & -\frac{1}{10} \\
0 & 0 & -\frac{1}{5} & \frac{3}{10}
\end{pmatrix}$$

## 二、利用分块解矩阵方程

### 📐 例题2.143
解矩阵方程 $AX = B$，其中：
$$A = \begin{pmatrix}
1 & 2 & 0 & 0 \\
3 & 4 & 0 & 0 \\
5 & 6 & 1 & 0 \\
7 & 8 & 0 & 1
\end{pmatrix}, \quad B = \begin{pmatrix}
1 & 0 \\
2 & 0 \\
3 & 1 \\
4 & 0
\end{pmatrix}$$

**解**：
将 $A$ 分块为 $A = \begin{pmatrix} A_1 & O \\ C & E \end{pmatrix}$，$X$ 和 $B$ 相应分块：
$$X = \begin{pmatrix} X_1 \\ X_2 \end{pmatrix}, \quad B = \begin{pmatrix} B_1 \\ B_2 \end{pmatrix}$$

其中：
$$A_1 = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}, C = \begin{pmatrix} 5 & 6 \\ 7 & 8 \end{pmatrix}, B_1 = \begin{pmatrix} 1 & 0 \\ 2 & 0 \end{pmatrix}, B_2 = \begin{pmatrix} 3 & 1 \\ 4 & 0 \end{pmatrix}$$

方程 $AX = B$ 变为：
$$\begin{pmatrix} A_1 & O \\ C & E \end{pmatrix}\begin{pmatrix} X_1 \\ X_2 \end{pmatrix} = \begin{pmatrix} B_1 \\ B_2 \end{pmatrix}$$

得到：
$$\begin{cases}
A_1X_1 = B_1 \\
CX_1 + X_2 = B_2
\end{cases}$$

先解第一个方程：
$$X_1 = A_1^{-1}B_1 = \begin{pmatrix} -2 & 1 \\ \frac{3}{2} & -\frac{1}{2} \end{pmatrix}\begin{pmatrix} 1 & 0 \\ 2 & 0 \end{pmatrix} = \begin{pmatrix} 0 & 0 \\ -\frac{1}{2} & 0 \end{pmatrix}$$

再求 $X_2$：
$$X_2 = B_2 - CX_1 = \begin{pmatrix} 3 & 1 \\ 4 & 0 \end{pmatrix} - \begin{pmatrix} 5 & 6 \\ 7 & 8 \end{pmatrix}\begin{pmatrix} 0 & 0 \\ -\frac{1}{2} & 0 \end{pmatrix} = \begin{pmatrix} 3 & 1 \\ 4 & 0 \end{pmatrix} - \begin{pmatrix} -3 & 0 \\ -4 & 0 \end{pmatrix} = \begin{pmatrix} 6 & 1 \\ 8 & 0 \end{pmatrix}$$

所以：
$$X = \begin{pmatrix} 0 & 0 \\ -\frac{1}{2} & 0 \\ 6 & 1 \\ 8 & 0 \end{pmatrix}$$

## 三、分块计算行列式

### 1. 降阶法

### 📐 例题2.144
计算 $n$ 阶行列式：
$$D_n = \begin{vmatrix}
a & b & b & \cdots & b & b \\
b & a & b & \cdots & b & b \\
b & b & a & \cdots & b & b \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
b & b & b & \cdots & a & b \\
c & c & c & \cdots & c & d
\end{vmatrix}$$

**解**：
将最后一行提出公因子 $c$（假设 $c \neq 0$）：
$$D_n = c\begin{vmatrix}
a & b & b & \cdots & b & b \\
b & a & b & \cdots & b & b \\
b & b & a & \cdots & b & b \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
b & b & b & \cdots & a & b \\
1 & 1 & 1 & \cdots & 1 & \frac{d}{c}
\end{vmatrix}$$

对前 $n-1$ 行都减去第 $n$ 行乘以 $b$：
$$D_n = c\begin{vmatrix}
a-b & 0 & 0 & \cdots & 0 & b-\frac{bd}{c} \\
0 & a-b & 0 & \cdots & 0 & b-\frac{bd}{c} \\
0 & 0 & a-b & \cdots & 0 & b-\frac{bd}{c} \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \cdots & a-b & b-\frac{bd}{c} \\
1 & 1 & 1 & \cdots & 1 & \frac{d}{c}
\end{vmatrix}$$

按最后一列展开：
$$D_n = c(a-b)^{n-2}\left[(a-b)\frac{d}{c} - (n-1)(b-\frac{bd}{c})\right]$$

化简得：
$$D_n = (a-b)^{n-2}[d(a-b) - c(n-1)b + bd(n-1)]$$
$$= (a-b)^{n-2}[ad - c(n-1)b]$$

### 2. 递推法

### 📐 例题2.145
设 $D_n = \begin{vmatrix}
2 & 1 & 0 & \cdots & 0 & 0 \\
1 & 2 & 1 & \cdots & 0 & 0 \\
0 & 1 & 2 & \cdots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \cdots & 2 & 1 \\
0 & 0 & 0 & \cdots & 1 & 2
\end{vmatrix}$，求 $D_n$。

**解**：
按第一行展开：
$$D_n = 2D_{n-1} - 1 \cdot \begin{vmatrix}
1 & 1 & 0 & \cdots & 0 \\
0 & 2 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \cdots & 2
\end{vmatrix} = 2D_{n-1} - D_{n-2}$$

特征方程：$r^2 - 2r + 1 = 0$，解得 $r = 1$（二重根）。

通解：$D_n = (c_1 + c_2n) \cdot 1^n = c_1 + c_2n$

由初始条件：$D_1 = 2$，$D_2 = 3$

解得：$c_1 = 1$，$c_2 = 1$

所以 $D_n = n + 1$。

## 四、分块矩阵在证明中的应用

### 📐 例题2.146
设 $A$ 是 $m \times n$ 矩阵，$B$ 是 $n \times m$ 矩阵，证明：
$$|E_m - AB| = |E_n - BA|$$

**证明**：
考虑分块矩阵：
$$M = \begin{pmatrix} E_m & A \\ B & E_n \end{pmatrix}$$

方法一：左乘 $\begin{pmatrix} E_m & O \\ -B & E_n \end{pmatrix}$：
$$\begin{pmatrix} E_m & O \\ -B & E_n \end{pmatrix}\begin{pmatrix} E_m & A \\ B & E_n \end{pmatrix} = \begin{pmatrix} E_m & A \\ O & E_n - BA \end{pmatrix}$$

所以 $|M| = |E_m| \cdot |E_n - BA| = |E_n - BA|$

方法二：右乘 $\begin{pmatrix} E_m & -A \\ O & E_n \end{pmatrix}$：
$$\begin{pmatrix} E_m & A \\ B & E_n \end{pmatrix}\begin{pmatrix} E_m & -A \\ O & E_n \end{pmatrix} = \begin{pmatrix} E_m - AB & O \\ B & E_n \end{pmatrix}$$

所以 $|M| = |E_m - AB| \cdot |E_n| = |E_m - AB|$

因此 $|E_m - AB| = |E_n - BA|$。

### 📐 例题2.147
设 $A$、$B$ 都是 $n$ 阶方阵，$A$ 可逆，证明：
$$r\begin{pmatrix} A & B \\ O & C \end{pmatrix} = r(A) + r(C)$$

**证明**：
左乘可逆矩阵 $\begin{pmatrix} A^{-1} & O \\ O & E \end{pmatrix}$：
$$\begin{pmatrix} A^{-1} & O \\ O & E \end{pmatrix}\begin{pmatrix} A & B \\ O & C \end{pmatrix} = \begin{pmatrix} E & A^{-1}B \\ O & C \end{pmatrix}$$

因为可逆矩阵不改变秩，所以：
$$r\begin{pmatrix} A & B \\ O & C \end{pmatrix} = r\begin{pmatrix} E & A^{-1}B \\ O & C \end{pmatrix}$$

显然右边矩阵的秩为 $n + r(C) = r(A) + r(C)$。

## 五、分块矩阵的实际应用

### 1. 大规模线性方程组

在求解大规模稀疏线性方程组时，合理的分块可以大大减少计算量。

### 📐 例题2.148
求解线性方程组，系数矩阵具有带状结构：
$$\begin{pmatrix}
B_1 & C_1 & & & \\
A_2 & B_2 & C_2 & & \\
& A_3 & B_3 & C_3 & \\
& & \ddots & \ddots & \ddots \\
& & & A_{n-1} & B_{n-1} & C_{n-1} \\
& & & & A_n & B_n
\end{pmatrix}\begin{pmatrix}
x_1 \\ x_2 \\ x_3 \\ \vdots \\ x_{n-1} \\ x_n
\end{pmatrix} = \begin{pmatrix}
d_1 \\ d_2 \\ d_3 \\ \vdots \\ d_{n-1} \\ d_n
\end{pmatrix}$$

这种三对角矩阵可以用追赶法（Thomas算法）高效求解。

### 2. 矩阵的谱分解

### 📐 例题2.149
设对称矩阵 $A = \begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix}$，将其对角化。

**解**：
特征多项式：$|A - \lambda E| = (2-\lambda)^2 - 1 = \lambda^2 - 4\lambda + 3 = 0$

特征值：$\lambda_1 = 3$，$\lambda_2 = 1$

特征向量：
- 对于 $\lambda_1 = 3$：$(A - 3E)x = 0$，得 $p_1 = \frac{1}{\sqrt{2}}\begin{pmatrix} 1 \\ 1 \end{pmatrix}$
- 对于 $\lambda_2 = 1$：$(A - E)x = 0$，得 $p_2 = \frac{1}{\sqrt{2}}\begin{pmatrix} 1 \\ -1 \end{pmatrix}$

令 $P = (p_1, p_2) = \frac{1}{\sqrt{2}}\begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix}$

则 $P^TAP = \begin{pmatrix} 3 & 0 \\ 0 & 1 \end{pmatrix}$

## 六、分块矩阵的高级技巧

### 📐 例题2.150
计算 $A^{100}$，其中 $A = \begin{pmatrix} 1 & 1 & 0 \\ 0 & 1 & 1 \\ 0 & 0 & 1 \end{pmatrix}$。

**解**：
注意到 $A = E + N$，其中 $N = \begin{pmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ 0 & 0 & 0 \end{pmatrix}$

计算得：$N^2 = \begin{pmatrix} 0 & 0 & 1 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{pmatrix}$，$N^3 = O$

由二项式定理：
$$A^{100} = (E + N)^{100} = \sum_{k=0}^{100} \binom{100}{k} N^k = E + 100N + \binom{100}{2}N^2$$

$$= \begin{pmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{pmatrix} + 100\begin{pmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ 0 & 0 & 0 \end{pmatrix} + 4950\begin{pmatrix} 0 & 0 & 1 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{pmatrix}$$

$$= \begin{pmatrix} 1 & 100 & 4950 \\ 0 & 1 & 100 \\ 0 & 0 & 1 \end{pmatrix}$$

## 🎯 易错提醒

1. **分块的合理性**：
   - 分块要能简化计算
   - 注意保持运算的可行性

2. **边界条件**：
   - 递推问题要正确设置初值
   - 注意矩阵阶数的限制

3. **可逆性假设**：
   - 使用分块求逆公式时要验证子块可逆
   - Schur补必须可逆

4. **符号问题**：
   - 反对角块的行列式有符号
   - 注意矩阵乘法的顺序

## 🔗 相关链接

- [[2-6-1 分块矩阵的定义与运算]]（基础知识）
- [[2-3-3 逆矩阵的计算方法]]（求逆方法）
- [[2-5-2 矩阵秩的性质]]（秩的性质）
- [[1-4-4 行列式的计算技巧]]（行列式计算）

## 🔗 相关题目练习
根据标签可在题库中搜索：
- 知识点标签：`分块求逆` `分块解方程` `分块求秩`
- 章节标签：`矩阵`
- 难度：`hard`

---
*学习提示：分块矩阵的应用非常广泛，关键是要有"分块思维"——看到复杂矩阵时，首先考虑能否通过分块简化。熟练掌握分块技巧，在考试中往往能够快速解决看似复杂的问题。记住：好的分块方式能让问题迎刃而解！*