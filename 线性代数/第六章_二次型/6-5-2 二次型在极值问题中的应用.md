# 6-5-2 二次型在极值问题中的应用

#数学二 #线性代数 #第六章 #二次型 #极值问题 #条件极值 #优化理论

## 🏷️ 标签体系
- **L1知识点**：`二次型极值` `条件极值` `Rayleigh商` `最优化` `Lagrange乘数`
- **L2方法**：`特征值方法` `配方法` `Lagrange乘数法` `矩阵分析`
- **L3章节**：`二次型`
- **难度**：`hard`

## 📖 概述

二次型在极值问题中起着核心作用，特别是在多元函数的极值判定、约束优化和数值分析中。本节将详细探讨二次型在各类极值问题中的应用。

### 💡 应用领域
1. **无约束极值**：Hessian矩阵判定
2. **约束极值**：二次规划
3. **特征值问题**：Rayleigh商
4. **最优化理论**：凸优化基础

## 一、多元函数的极值判定

### 📖 二阶充分条件

设$f: \mathbb{R}^n \to \mathbb{R}$二阶连续可微，$X_0$是驻点（$\nabla f(X_0) = 0$），$H(X_0)$是Hessian矩阵：

1. $H(X_0)$**正定** → $X_0$是**严格局部极小点**
2. $H(X_0)$**负定** → $X_0$是**严格局部极大点**
3. $H(X_0)$**不定** → $X_0$是**鞍点**
4. $H(X_0)$**半定** → 需要高阶导数判定

### 🔑 Hessian矩阵

$$H = \begin{pmatrix}
\frac{\partial^2 f}{\partial x_1^2} & \cdots & \frac{\partial^2 f}{\partial x_1 \partial x_n} \\
\vdots & \ddots & \vdots \\
\frac{\partial^2 f}{\partial x_n \partial x_1} & \cdots & \frac{\partial^2 f}{\partial x_n^2}
\end{pmatrix}$$

### 📐 例题6.94（极值判定）

求函数$f(x,y,z) = x^2 + y^2 + z^2 - xy + x - 2z$的极值。

**解**：

**第一步**：求驻点
$$\nabla f = \begin{pmatrix} 2x - y + 1 \\ 2y - x \\ 2z - 2 \end{pmatrix} = 0$$

解得：$x = -\frac{2}{3}, y = -\frac{1}{3}, z = 1$

**第二步**：计算Hessian矩阵
$$H = \begin{pmatrix} 2 & -1 & 0 \\ -1 & 2 & 0 \\ 0 & 0 & 2 \end{pmatrix}$$

**第三步**：判定正定性
顺序主子式：$D_1 = 2 > 0, D_2 = 3 > 0, D_3 = 6 > 0$

$H$正定，所以$(-\frac{2}{3}, -\frac{1}{3}, 1)$是严格局部极小点。

**第四步**：计算极小值
$$f_{\min} = \frac{4}{9} + \frac{1}{9} + 1 + \frac{2}{9} - \frac{2}{3} - 2 = -\frac{4}{3}$$

## 二、条件极值与二次型

### 📖 约束优化问题

$$\begin{cases}
\text{minimize} & f(X) = \frac{1}{2}X^TAX + b^TX + c \\
\text{subject to} & g(X) = 0
\end{cases}$$

其中$A$是对称矩阵。

### 🔑 Lagrange乘数法

构造Lagrange函数：
$$L(X, \lambda) = f(X) + \lambda g(X)$$

### 📐 例题6.95（条件极值）

求$f(x,y,z) = x^2 + 2y^2 + 3z^2$在约束$x + y + z = 1$下的极值。

**解**：

Lagrange函数：
$$L = x^2 + 2y^2 + 3z^2 + \lambda(x + y + z - 1)$$

求导：
$$\begin{cases}
\frac{\partial L}{\partial x} = 2x + \lambda = 0 \\
\frac{\partial L}{\partial y} = 4y + \lambda = 0 \\
\frac{\partial L}{\partial z} = 6z + \lambda = 0 \\
x + y + z = 1
\end{cases}$$

解得：$x = \frac{3}{11}, y = \frac{3}{22}, z = \frac{1}{11}$

极小值：$f_{\min} = \frac{6}{11}$

## 三、Rayleigh商与特征值

### 📖 Rayleigh商定义

对于实对称矩阵$A$，Rayleigh商定义为：
$$R(X) = \frac{X^TAX}{X^TX}, \quad X \neq 0$$

### 🔑 极值性质

1. $\min_{X \neq 0} R(X) = \lambda_{\min}$（最小特征值）
2. $\max_{X \neq 0} R(X) = \lambda_{\max}$（最大特征值）
3. 极值在对应的特征向量处取得

### 📐 例题6.96（Rayleigh商应用）

设$A = \begin{pmatrix} 4 & 2 \\ 2 & 7 \end{pmatrix}$，求$R(X) = \frac{X^TAX}{X^TX}$的极值。

**解**：

**方法一**：直接计算特征值
特征方程：$|\lambda I - A| = \lambda^2 - 11\lambda + 24 = 0$
特征值：$\lambda_1 = 8, \lambda_2 = 3$

所以：$\min R(X) = 3, \max R(X) = 8$

**方法二**：约束优化
在$||X|| = 1$的约束下极值化$X^TAX$

设$X = (\cos\theta, \sin\theta)^T$，则：
$$R = 4\cos^2\theta + 4\cos\theta\sin\theta + 7\sin^2\theta$$

求导得极值点，验证得同样结果。

## 四、二次规划

### 📖 标准二次规划

$$\begin{cases}
\text{minimize} & \frac{1}{2}X^TQX + c^TX \\
\text{subject to} & AX = b \\
& X \geq 0
\end{cases}$$

其中$Q$是正定或半正定矩阵。

### 💡 最优性条件

KKT条件是二次规划最优解的充要条件。

### 📐 例题6.97（简单二次规划）

求解：
$$\begin{cases}
\text{minimize} & x^2 + y^2 - 2x - 4y \\
\text{subject to} & x + y \leq 2 \\
& x, y \geq 0
\end{cases}$$

**解**：

目标函数配方：
$$f = (x-1)^2 + (y-2)^2 - 5$$

无约束最优点：$(1, 2)$

检验约束：$1 + 2 = 3 > 2$，违反约束

在边界$x + y = 2$上：
$$f = (x-1)^2 + (2-x-2)^2 - 5 = 2(x-1)^2 - 5$$

最优解：$x = 1, y = 1$，最优值：$f = -4$

## 五、凸优化中的应用

### 📖 凸函数判定

二次函数$f(X) = \frac{1}{2}X^TAX + b^TX + c$是凸函数$\Leftrightarrow$ $A$半正定。

### 🔑 强凸性

$f$是强凸的$\Leftrightarrow$ $A$正定。

### 📐 例题6.98（凸性判定）

判定函数$f(x,y) = 2x^2 + 3y^2 - 2xy + x - y$的凸性。

**解**：

Hessian矩阵：
$$H = \begin{pmatrix} 4 & -2 \\ -2 & 6 \end{pmatrix}$$

顺序主子式：$D_1 = 4 > 0, D_2 = 20 > 0$

$H$正定，所以$f$是强凸函数。

这保证了：
- 局部最优即全局最优
- 最优解唯一
- 梯度下降法收敛

## 六、数值优化算法

### 📖 牛顿法

对于极小化$f(X)$，牛顿法迭代：
$$X_{k+1} = X_k - H^{-1}(X_k)\nabla f(X_k)$$

收敛性依赖于$H$的正定性。

### 📖 共轭梯度法

利用$A$的正定性构造共轭方向。

### 📐 例题6.99（优化算法）

用牛顿法求$f(x,y) = x^2 + 2y^2 - 2x + 4y$的最小值。

**解**：

梯度：$\nabla f = (2x - 2, 4y + 4)^T$

Hessian：$H = \begin{pmatrix} 2 & 0 \\ 0 & 4 \end{pmatrix}$

牛顿迭代：
$$\begin{pmatrix} x_{k+1} \\ y_{k+1} \end{pmatrix} = \begin{pmatrix} x_k \\ y_k \end{pmatrix} - \begin{pmatrix} 1/2 & 0 \\ 0 & 1/4 \end{pmatrix} \begin{pmatrix} 2x_k - 2 \\ 4y_k + 4 \end{pmatrix}$$

由于是二次函数且$H$正定，一步迭代即可得到精确解：$(1, -1)$

## 七、实际应用

### 📖 最小二乘问题

$$\min ||AX - b||^2 = \min (X^TA^TAX - 2b^TAX + b^Tb)$$

正规方程：$A^TAX = A^Tb$

### 📖 投资组合优化

最小化风险（方差）：
$$\min X^T\Sigma X$$
其中$\Sigma$是协方差矩阵（正定）。

### 📐 例题6.100（应用实例）

某投资组合有两种资产，协方差矩阵$\Sigma = \begin{pmatrix} 4 & 1 \\ 1 & 2 \end{pmatrix}$，在预期收益率为10%的约束下，求最小风险组合。

**解**：

设投资比例为$(x, y)$，约束：
- $x + y = 1$（全部投资）
- $8x + 12y = 10$（预期收益）

解约束方程：$x = 0.5, y = 0.5$

风险（方差）：
$$\sigma^2 = 0.5^2 \times 4 + 2 \times 0.5 \times 0.5 \times 1 + 0.5^2 \times 2 = 2$$

## 🎯 易错提醒

1. **驻点判定**：先确认是驻点再用Hessian判定
2. **边界考虑**：约束优化要检查边界
3. **半定情形**：需要高阶导数或其他方法
4. **全局vs局部**：二次型判定的是局部性质

## 🔗 相关链接
- [[6-4-1 正定二次型的概念]]
- [[4-5-2 多元函数的极值]]
- [[6-3-3 二次型的分类]]
- [[5-2-1 特征值的计算方法]]

## 🔗 相关题目练习
根据标签可在题库中搜索：
- 知识点标签：`二次型极值` `条件极值` `Rayleigh商`
- 章节标签：`二次型`
- 难度：`hard`