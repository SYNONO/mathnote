# 4-2-2 非齐次方程组解的判定

#线性代数 #线性方程组 #非齐次方程组 #解的判定 #数学二 #考研数学

## 📌 知识概述

非齐次线性方程组是常数项不全为零的方程组，其解的存在性不像齐次方程组那样显然。判断非齐次方程组是否有解、有多少解，需要同时考虑系数矩阵和增广矩阵的秩。这一理论是线性方程组的核心内容，在实际应用中极为重要。

## 📝 基本概念

### 非齐次线性方程组

形如 $Ax = b$（其中 $b \neq 0$）的方程组称为**非齐次线性方程组**：

$$\begin{cases}
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1 \\
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2 \\
\vdots \\
a_{m1}x_1 + a_{m2}x_2 + \cdots + a_{mn}x_n = b_m
\end{cases}$$

其中至少有一个 $b_i \neq 0$。

### 相关概念

1. **系数矩阵**：$A = (a_{ij})_{m \times n}$
2. **增广矩阵**：$(A|b) = \begin{pmatrix} A & b \end{pmatrix}$
3. **导出组**：对应的齐次方程组 $Ax = 0$

## 🎯 解的判定定理

### 核心判定定理（相容性定理）

非齐次线性方程组 $Ax = b$ 的解的情况由以下秩的关系决定：

1. **无解** ⟺ $r(A) < r(A|b)$
2. **有解** ⟺ $r(A) = r(A|b)$
   - **唯一解** ⟺ $r(A) = r(A|b) = n$
   - **无穷多解** ⟺ $r(A) = r(A|b) < n$

### 判定准则详解

| 秩的关系 | 解的情况 | 自由变量个数 | 几何意义 |
|----------|----------|--------------|----------|
| $r(A) < r(A\|b)$ | 无解 | — | 矛盾方程组 |
| $r(A) = r(A\|b) = n$ | 唯一解 | 0 | 唯一交点 |
| $r(A) = r(A\|b) < n$ | 无穷多解 | $n - r(A)$ | 线或面的交集 |

💡 **关键理解**：
- $r(A|b) - r(A) \in \{0, 1\}$（只能相等或差1）
- 当出现矛盾行如 $(0, 0, \cdots, 0 | c)$，$c \neq 0$ 时无解

## 💡 解的结构定理

### 非齐次方程组解的结构

若非齐次方程组 $Ax = b$ 有解，则：

1. **通解 = 特解 + 导出组的通解**

   设 $\eta$ 是 $Ax = b$ 的一个特解，$\xi$ 是 $Ax = 0$ 的通解，则 $Ax = b$ 的通解为：
   $$x = \eta + \xi$$

2. **特解不唯一，但通解形式唯一**

3. **任意两个特解之差是导出组的解**

### 向量形式的理解

方程组 $Ax = b$ 有解 ⟺ $b$ 可由 $A$ 的列向量线性表示

设 $A = (\alpha_1, \alpha_2, \cdots, \alpha_n)$，则：
- 有解 ⟺ $b \in \text{span}\{\alpha_1, \alpha_2, \cdots, \alpha_n\}$
- 无解 ⟺ $b \notin \text{span}\{\alpha_1, \alpha_2, \cdots, \alpha_n\}$

## 📊 典型例题

### 例题1：解的存在性判定

判断方程组是否有解：
$$\begin{cases}
x_1 + 2x_2 - x_3 = 1 \\
2x_1 + 3x_2 + x_3 = 3 \\
3x_1 + 5x_2 = 5
\end{cases}$$

**解答**：

构造增广矩阵：
$$(A|b) = \begin{pmatrix}
1 & 2 & -1 & | & 1 \\
2 & 3 & 1 & | & 3 \\
3 & 5 & 0 & | & 5
\end{pmatrix}$$

进行行变换：
$$\xrightarrow{r_2-2r_1, r_3-3r_1} \begin{pmatrix}
1 & 2 & -1 & | & 1 \\
0 & -1 & 3 & | & 1 \\
0 & -1 & 3 & | & 2
\end{pmatrix}$$

$$\xrightarrow{r_3-r_2} \begin{pmatrix}
1 & 2 & -1 & | & 1 \\
0 & -1 & 3 & | & 1 \\
0 & 0 & 0 & | & 1
\end{pmatrix}$$

最后一行表示 $0 = 1$，矛盾！

因此 $r(A) = 2 < r(A|b) = 3$，方程组无解。

### 例题2：含参数的讨论

讨论方程组的解的情况：
$$\begin{cases}
x_1 + x_2 + x_3 = 1 \\
x_1 + 2x_2 + ax_3 = 2 \\
x_1 + 3x_2 + a^2x_3 = b
\end{cases}$$

**解答**：

增广矩阵：
$$(A|b) = \begin{pmatrix}
1 & 1 & 1 & | & 1 \\
1 & 2 & a & | & 2 \\
1 & 3 & a^2 & | & b
\end{pmatrix}$$

行变换：
$$\xrightarrow{r_2-r_1, r_3-r_1} \begin{pmatrix}
1 & 1 & 1 & | & 1 \\
0 & 1 & a-1 & | & 1 \\
0 & 2 & a^2-1 & | & b-1
\end{pmatrix}$$

$$\xrightarrow{r_3-2r_2} \begin{pmatrix}
1 & 1 & 1 & | & 1 \\
0 & 1 & a-1 & | & 1 \\
0 & 0 & (a-1)(a+1) & | & b-3
\end{pmatrix}$$

分类讨论：

1. **当 $a \neq 1$ 且 $a \neq -1$ 时**：
   - $r(A) = r(A|b) = 3 = n$
   - 唯一解

2. **当 $a = 1$ 时**：
   $$(A|b) \rightarrow \begin{pmatrix}
   1 & 1 & 1 & | & 1 \\
   0 & 1 & 0 & | & 1 \\
   0 & 0 & 0 & | & b-3
   \end{pmatrix}$$
   - 若 $b = 3$：$r(A) = r(A|b) = 2 < 3$，无穷多解
   - 若 $b \neq 3$：$r(A) = 2 < r(A|b) = 3$，无解

3. **当 $a = -1$ 时**：
   $$(A|b) \rightarrow \begin{pmatrix}
   1 & 1 & 1 & | & 1 \\
   0 & 1 & -2 & | & 1 \\
   0 & 0 & 0 & | & b-3
   \end{pmatrix}$$
   - 若 $b = 3$：$r(A) = r(A|b) = 2 < 3$，无穷多解
   - 若 $b \neq 3$：$r(A) = 2 < r(A|b) = 3$，无解

### 例题3：求解非齐次方程组

求解方程组：
$$\begin{cases}
x_1 + 2x_2 - x_3 + x_4 = 1 \\
2x_1 + 3x_2 + x_3 - x_4 = 2 \\
3x_1 + 5x_2 + 2x_4 = 4
\end{cases}$$

**解答**：

增广矩阵化简：
$$(A|b) = \begin{pmatrix}
1 & 2 & -1 & 1 & | & 1 \\
2 & 3 & 1 & -1 & | & 2 \\
3 & 5 & 0 & 2 & | & 4
\end{pmatrix}$$

$$\rightarrow \begin{pmatrix}
1 & 2 & -1 & 1 & | & 1 \\
0 & -1 & 3 & -3 & | & 0 \\
0 & 0 & 0 & 0 & | & 1
\end{pmatrix}$$

等等，这里出错了。重新计算：

$$\xrightarrow{r_2-2r_1, r_3-3r_1} \begin{pmatrix}
1 & 2 & -1 & 1 & | & 1 \\
0 & -1 & 3 & -3 & | & 0 \\
0 & -1 & 3 & -1 & | & 1
\end{pmatrix}$$

$$\xrightarrow{r_3-r_2} \begin{pmatrix}
1 & 2 & -1 & 1 & | & 1 \\
0 & -1 & 3 & -3 & | & 0 \\
0 & 0 & 0 & 2 & | & 1
\end{pmatrix}$$

从最后一行：$2x_4 = 1$ → $x_4 = \frac{1}{2}$

设 $x_3 = t$（自由变量），从第二行：
$-x_2 + 3t - \frac{3}{2} = 0$ → $x_2 = 3t - \frac{3}{2}$

从第一行：
$x_1 + 2(3t - \frac{3}{2}) - t + \frac{1}{2} = 1$
$x_1 = 1 - 6t + 3 + t - \frac{1}{2} = \frac{7}{2} - 5t$

通解为：
$$x = \begin{pmatrix} \frac{7}{2} \\ -\frac{3}{2} \\ 0 \\ \frac{1}{2} \end{pmatrix} + t\begin{pmatrix} -5 \\ 3 \\ 1 \\ 0 \end{pmatrix}$$

## 🎓 深入理解

### 1. 为什么 $r(A|b) - r(A) \leq 1$？

增广矩阵 $(A|b)$ 比系数矩阵 $A$ 多一列，而矩阵的秩最多增加1。

### 2. 几何意义

在 $\mathbb{R}^3$ 中：
- 每个方程代表一个平面
- 无解：平面没有公共交点（平行或成三角形）
- 唯一解：三个平面交于一点
- 无穷多解：三个平面交于一条直线或重合

### 3. 与齐次方程组的关系

- 非齐次有解 ⟺ 对应齐次只影响解的个数
- 非齐次无解与对应齐次无关
- 解的结构：非齐次通解 = 特解 + 齐次通解

## ⚠️ 易错提醒

### 1. 秩的计算

- ❌ 只看系数矩阵的秩
- ✅ 必须同时计算 $r(A)$ 和 $r(A|b)$

### 2. 解的判断

- ❌ 认为非齐次方程组一定有解
- ✅ 需要验证相容性条件

### 3. 通解表达

- 特解可以任选一个
- 自由变量的选择不唯一
- 最终通解形式应该相同

### 4. 参数讨论

- 注意参数的临界值
- 每种情况都要判断解的个数
- 不要遗漏任何情况

## 📋 总结提升

### 核心要点

1. 非齐次方程组可能无解、唯一解或无穷多解
2. 相容性条件：$r(A) = r(A|b)$
3. 解的个数由 $r(A)$ 与 $n$ 的关系决定
4. 通解结构：特解 + 导出组通解

### 判定流程图

```
非齐次方程组 Ax = b
        ↓
  计算 r(A) 和 r(A|b)
        ↓
    r(A) = r(A|b)?
    ↙          ↘
   是           否
   ↓            ↓
 有解          无解
   ↓
r(A) = n?
↙      ↘
是       否
↓        ↓
唯一解   无穷多解
```

### 方法总结

1. **增广矩阵法**：直接对 $(A|b)$ 进行行变换
2. **向量法**：判断 $b$ 能否由列向量线性表示
3. **克拉默法则**：当 $m = n$ 且 $|A| \neq 0$ 时使用

## 🔗 相关链接

- 对比学习：[[4-2-1 齐次方程组解的判定]]
- 解的结构：[[4-4-2 特解与通解]]
- 判定方法：[[4-2-4 相容性定理]]
- 特殊情况：[[4-5-1 克拉默法则的内容]]

---

*非齐次方程组——现实问题的数学模型！*