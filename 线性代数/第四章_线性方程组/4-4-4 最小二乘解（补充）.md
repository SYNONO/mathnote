# 4-4-4 最小二乘解（补充）

#线性代数 #线性方程组 #最小二乘法 #数值方法 #数学二 #考研数学

## 📌 知识概述

最小二乘解是处理不相容（无解）线性方程组的重要方法。当方程组 $Ax = b$ 无精确解时，我们寻找使误差 $\|Ax - b\|$ 最小的近似解。这在数据拟合、参数估计、信号处理等领域有广泛应用。虽然最小二乘法不是数学二的必考内容，但了解它有助于深入理解线性方程组理论。

## 📝 基本概念

### 最小二乘问题

对于可能无解的方程组 $Ax = b$，最小二乘问题是：
$$\min_{x \in \mathbb{R}^n} \|Ax - b\|^2$$

其中 $\|v\| = \sqrt{v^Tv}$ 是向量的欧几里得范数。

### 最小二乘解

使目标函数 $\|Ax - b\|^2$ 达到最小值的 $x$ 称为**最小二乘解**。

### 残差向量

$r = b - Ax$ 称为残差向量，最小二乘解使 $\|r\|$ 最小。

## 🎯 正规方程

### 导出过程

目标函数：
$$f(x) = \|Ax - b\|^2 = (Ax - b)^T(Ax - b)$$

展开：
$$f(x) = x^TA^TAx - 2x^TA^Tb + b^Tb$$

求导并令其为零：
$$\frac{\partial f}{\partial x} = 2A^TAx - 2A^Tb = 0$$

得到**正规方程**（Normal Equation）：
$$A^TAx = A^Tb$$

### 解的存在性

**定理**：正规方程 $A^TAx = A^Tb$ 总是相容的（有解）。

**证明**：$r(A^TA) = r(A^TA|A^Tb) = r(A)$

### 解的唯一性

- 当 $A$ 列满秩（$r(A) = n$）时，最小二乘解唯一
- 当 $A$ 列不满秩时，有无穷多最小二乘解

## 💡 几何意义

### 投影解释

最小二乘解对应于 $b$ 在 $A$ 的列空间上的正交投影：

1. **列空间**：$\text{Col}(A) = \{Ax : x \in \mathbb{R}^n\}$
2. **投影**：$\hat{b} = Ax_{LS}$ 是 $b$ 在 $\text{Col}(A)$ 上的投影
3. **正交性**：$b - \hat{b} \perp \text{Col}(A)$

### 正交条件

残差向量与 $A$ 的每一列正交：
$$A^T(b - Ax_{LS}) = 0$$

这正是正规方程！

## 📊 典型例题

### 例题1：求最小二乘解

求不相容方程组的最小二乘解：
$$\begin{cases}
x_1 + x_2 = 1 \\
x_1 - x_2 = 3 \\
2x_1 = 3
\end{cases}$$

**解答**：

写成矩阵形式：
$$A = \begin{pmatrix} 1 & 1 \\ 1 & -1 \\ 2 & 0 \end{pmatrix}, \quad b = \begin{pmatrix} 1 \\ 3 \\ 3 \end{pmatrix}$$

计算 $A^TA$ 和 $A^Tb$：
$$A^TA = \begin{pmatrix} 1 & 1 & 2 \\ 1 & -1 & 0 \end{pmatrix} \begin{pmatrix} 1 & 1 \\ 1 & -1 \\ 2 & 0 \end{pmatrix} = \begin{pmatrix} 6 & 0 \\ 0 & 2 \end{pmatrix}$$

$$A^Tb = \begin{pmatrix} 1 & 1 & 2 \\ 1 & -1 & 0 \end{pmatrix} \begin{pmatrix} 1 \\ 3 \\ 3 \end{pmatrix} = \begin{pmatrix} 10 \\ -2 \end{pmatrix}$$

解正规方程：
$$\begin{pmatrix} 6 & 0 \\ 0 & 2 \end{pmatrix} \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} = \begin{pmatrix} 10 \\ -2 \end{pmatrix}$$

得：$x_1 = \frac{10}{6} = \frac{5}{3}$，$x_2 = -1$

最小二乘解：$x_{LS} = \begin{pmatrix} \frac{5}{3} \\ -1 \end{pmatrix}$

验证残差：
$$Ax_{LS} = \begin{pmatrix} \frac{2}{3} \\ \frac{8}{3} \\ \frac{10}{3} \end{pmatrix}, \quad r = b - Ax_{LS} = \begin{pmatrix} \frac{1}{3} \\ \frac{1}{3} \\ -\frac{1}{3} \end{pmatrix}$$

### 例题2：数据拟合

用直线 $y = a + bx$ 拟合数据点：$(1,2), (2,3), (3,5), (4,6)$

**解答**：

建立方程组：
$$\begin{cases}
a + b = 2 \\
a + 2b = 3 \\
a + 3b = 5 \\
a + 4b = 6
\end{cases}$$

矩阵形式：
$$A = \begin{pmatrix} 1 & 1 \\ 1 & 2 \\ 1 & 3 \\ 1 & 4 \end{pmatrix}, \quad x = \begin{pmatrix} a \\ b \end{pmatrix}, \quad b = \begin{pmatrix} 2 \\ 3 \\ 5 \\ 6 \end{pmatrix}$$

计算：
$$A^TA = \begin{pmatrix} 4 & 10 \\ 10 & 30 \end{pmatrix}, \quad A^Tb = \begin{pmatrix} 16 \\ 46 \end{pmatrix}$$

解正规方程：
$$\begin{cases}
4a + 10b = 16 \\
10a + 30b = 46
\end{cases}$$

消元得：$b = 1.4$，$a = 0.5$

最佳拟合直线：$y = 0.5 + 1.4x$

### 例题3：最小二乘解的性质

证明：若 $x_{LS}$ 是 $Ax = b$ 的最小二乘解，则对任意 $x \in \mathbb{R}^n$：
$$\|b - Ax_{LS}\|^2 + \|A(x - x_{LS})\|^2 = \|b - Ax\|^2$$

**证明**：

设 $r = b - Ax_{LS}$（残差），$\delta = x - x_{LS}$

则：
$$b - Ax = b - A(x_{LS} + \delta) = (b - Ax_{LS}) - A\delta = r - A\delta$$

因为 $A^Tr = 0$（正交条件），所以：
$$\|b - Ax\|^2 = \|r - A\delta\|^2 = \|r\|^2 + \|A\delta\|^2 - 2r^TA\delta$$

由于 $r^TA = (A^Tr)^T = 0$，所以：
$$\|b - Ax\|^2 = \|r\|^2 + \|A\delta\|^2 = \|b - Ax_{LS}\|^2 + \|A(x - x_{LS})\|^2$$

这就是**勾股定理**在最小二乘中的体现！

## 🎓 计算方法

### 1. 正规方程法

适用于 $A^TA$ 条件数不大的情况：
1. 计算 $A^TA$ 和 $A^Tb$
2. 解线性方程组 $A^TAx = A^Tb$

### 2. QR分解法

更稳定的数值方法：
1. 对 $A$ 进行QR分解：$A = QR$
2. 解 $Rx = Q^Tb$

### 3. 奇异值分解（SVD）

最稳定但计算量大：
1. 对 $A$ 进行SVD：$A = U\Sigma V^T$
2. 最小二乘解：$x = V\Sigma^+U^Tb$

## ⚠️ 注意事项

### 1. 应用前提

- 确认方程组确实无解
- 或者需要处理测量误差
- 明确最小化的是2-范数

### 2. 数值稳定性

- 直接计算 $A^TA$ 可能导致条件数变差
- 优先使用QR分解等稳定算法
- 注意舍入误差的影响

### 3. 解的解释

- 最小二乘解是"最佳近似解"
- 残差反映了拟合误差
- 可用于评估模型质量

## 📋 总结提升

### 核心要点

1. 最小二乘解使 $\|Ax - b\|$ 最小
2. 通过正规方程 $A^TAx = A^Tb$ 求解
3. 几何上是投影问题
4. 广泛应用于数据拟合

### 与精确解的关系

| 情况 | 精确解 | 最小二乘解 |
|------|--------|------------|
| 相容方程组 | 存在 | 等于精确解 |
| 不相容方程组 | 不存在 | 最佳近似 |
| 列满秩 | 唯一（若存在） | 唯一 |
| 列不满秩 | 无穷多（若存在） | 无穷多 |

### 应用领域

1. **数据拟合**：回归分析
2. **信号处理**：滤波、降噪
3. **图像处理**：重建、修复
4. **机器学习**：线性回归、岭回归

## 🔗 相关链接

- 理论基础：[[4-2-2 非齐次方程组解的判定]]
- 精确求解：[[4-4-2 特解与通解]]
- 数值方法：[[2-6-3 矩阵的QR分解]]（如有）
- 应用实例：数据分析、统计学

---

*最小二乘法——当完美不存在时，追求最佳！*