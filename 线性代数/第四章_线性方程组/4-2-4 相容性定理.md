# 4-2-4 相容性定理

#线性代数 #线性方程组 #相容性定理 #秩 #理论总结 #数学二 #考研数学

## 📌 知识概述

相容性定理（Compatibility Theorem）是线性方程组理论的核心定理，它给出了方程组有解的充要条件。这个定理不仅统一了齐次和非齐次方程组的判定方法，还揭示了秩在方程组理论中的核心地位。深刻理解相容性定理，对掌握整个线性方程组理论至关重要。

## 📝 相容性定理的表述

### 基本定理

**定理（Rouché-Capelli）**：线性方程组 $Ax = b$ 有解的充要条件是：
$$r(A) = r(A|b)$$

其中 $A$ 是系数矩阵，$(A|b)$ 是增广矩阵。

### 定理的完整表述

对于 $m \times n$ 线性方程组 $Ax = b$：

1. **相容（有解）** ⟺ $r(A) = r(A|b)$
   - **唯一解** ⟺ $r(A) = r(A|b) = n$
   - **无穷多解** ⟺ $r(A) = r(A|b) < n$

2. **不相容（无解）** ⟺ $r(A) < r(A|b)$

### 等价表述

方程组 $Ax = b$ 有解等价于：
- $b$ 可由 $A$ 的列向量线性表示
- $b \in \text{Col}(A)$（$b$ 在 $A$ 的列空间中）
- 向量组 $\{\alpha_1, \alpha_2, \cdots, \alpha_n\}$ 与 $\{\alpha_1, \alpha_2, \cdots, \alpha_n, b\}$ 的秩相同

## 🎯 定理的证明思路

### 证明概要

**必要性**（有解 ⟹ $r(A) = r(A|b)$）：

设 $x_0$ 是方程组的解，即 $Ax_0 = b$。则：
$$b = x_1^0\alpha_1 + x_2^0\alpha_2 + \cdots + x_n^0\alpha_n$$

这说明 $b$ 可由 $A$ 的列向量线性表示，故添加 $b$ 不增加秩。

**充分性**（$r(A) = r(A|b)$ ⟹ 有解）：

若 $r(A) = r(A|b) = r$，则 $A$ 的极大线性无关组也是 $(A|b)$ 的极大线性无关组，因此 $b$ 可由 $A$ 的列向量线性表示，方程组有解。

### 几何理解

- $r(A) = r(A|b)$：$b$ 在 $A$ 的列向量张成的空间内
- $r(A) < r(A|b)$：$b$ 在 $A$ 的列向量张成的空间外

## 💡 定理的应用

### 1. 判定方程组是否有解

通过计算两个秩，立即判断方程组的相容性。

### 2. 确定解的结构

- 基础解系的维数：$n - r(A)$
- 特解的存在性：当 $r(A) = r(A|b)$ 时存在

### 3. 参数方程组的讨论

含参数时，找出使 $r(A) \neq r(A|b)$ 的参数值。

### 4. 最小二乘解

当方程组不相容时，可以寻找最小二乘解。

## 📊 典型例题

### 例题1：验证相容性定理

验证方程组的相容性：
$$\begin{cases}
x_1 - x_2 + 2x_3 = 1 \\
2x_1 + x_2 - x_3 = 2 \\
x_1 - 4x_2 + 7x_3 = 0
\end{cases}$$

**解答**：

增广矩阵：
$$(A|b) = \begin{pmatrix}
1 & -1 & 2 & | & 1 \\
2 & 1 & -1 & | & 2 \\
1 & -4 & 7 & | & 0
\end{pmatrix}$$

进行行变换：
$$\xrightarrow{r_2-2r_1, r_3-r_1} \begin{pmatrix}
1 & -1 & 2 & | & 1 \\
0 & 3 & -5 & | & 0 \\
0 & -3 & 5 & | & -1
\end{pmatrix}$$

$$\xrightarrow{r_3+r_2} \begin{pmatrix}
1 & -1 & 2 & | & 1 \\
0 & 3 & -5 & | & 0 \\
0 & 0 & 0 & | & -1
\end{pmatrix}$$

观察结果：
- $r(A) = 2$（前两列线性无关）
- $r(A|b) = 3$（第三行使秩增加）
- 因为 $r(A) < r(A|b)$，方程组不相容（无解）

第三行表示 $0 = -1$，验证了无解的结论。

### 例题2：相容性与向量表示

设 $A = \begin{pmatrix} 1 & 2 & 3 \\ 2 & 3 & 4 \\ 3 & 5 & 7 \end{pmatrix}$，$b = \begin{pmatrix} 1 \\ 3 \\ 4 \end{pmatrix}$

判断 $Ax = b$ 是否有解，并说明 $b$ 与 $A$ 的列向量的关系。

**解答**：

设 $A$ 的列向量为 $\alpha_1 = \begin{pmatrix} 1 \\ 2 \\ 3 \end{pmatrix}$，$\alpha_2 = \begin{pmatrix} 2 \\ 3 \\ 5 \end{pmatrix}$，$\alpha_3 = \begin{pmatrix} 3 \\ 4 \\ 7 \end{pmatrix}$

计算增广矩阵的秩：
$$(A|b) = \begin{pmatrix}
1 & 2 & 3 & | & 1 \\
2 & 3 & 4 & | & 3 \\
3 & 5 & 7 & | & 4
\end{pmatrix}$$

行变换后得：
$$\begin{pmatrix}
1 & 2 & 3 & | & 1 \\
0 & -1 & -2 & | & 1 \\
0 & 0 & 0 & | & 0
\end{pmatrix}$$

因此 $r(A) = r(A|b) = 2$，方程组有解。

这说明 $b$ 可以表示为：$b = x_1\alpha_1 + x_2\alpha_2 + x_3\alpha_3$

具体地，取 $x_3 = 0$，得 $x_2 = -1$，$x_1 = 3$

验证：$3\alpha_1 - \alpha_2 = 3\begin{pmatrix} 1 \\ 2 \\ 3 \end{pmatrix} - \begin{pmatrix} 2 \\ 3 \\ 5 \end{pmatrix} = \begin{pmatrix} 1 \\ 3 \\ 4 \end{pmatrix} = b$ ✓

### 例题3：参数与相容性

讨论含参数方程组的相容性：
$$\begin{cases}
x + y + z = 1 \\
x + 2y + 3z = 2 \\
x + 3y + \lambda z = \mu
\end{cases}$$

**解答**：

增广矩阵：
$$(A|b) = \begin{pmatrix}
1 & 1 & 1 & | & 1 \\
1 & 2 & 3 & | & 2 \\
1 & 3 & \lambda & | & \mu
\end{pmatrix}$$

化简：
$$\rightarrow \begin{pmatrix}
1 & 1 & 1 & | & 1 \\
0 & 1 & 2 & | & 1 \\
0 & 2 & \lambda-1 & | & \mu-1
\end{pmatrix}$$

$$\rightarrow \begin{pmatrix}
1 & 1 & 1 & | & 1 \\
0 & 1 & 2 & | & 1 \\
0 & 0 & \lambda-5 & | & \mu-3
\end{pmatrix}$$

**分类讨论**：

1. **当 $\lambda \neq 5$ 时**：
   - $r(A) = r(A|b) = 3$
   - 方程组相容，有唯一解

2. **当 $\lambda = 5$ 时**：
   - 若 $\mu = 3$：$r(A) = r(A|b) = 2 < 3$，相容，无穷多解
   - 若 $\mu \neq 3$：$r(A) = 2 < r(A|b) = 3$，不相容，无解

## 🎓 理论深化

### 1. 秩的本质

秩反映了线性独立的程度：
- $r(A)$：系数矩阵包含的独立信息量
- $r(A|b)$：加入常数项后的独立信息量
- 相容性：常数项是否带来新的独立信息

### 2. 列空间视角

- $\text{Col}(A) = \{Ax : x \in \mathbb{R}^n\}$
- 方程组有解 ⟺ $b \in \text{Col}(A)$
- $\dim(\text{Col}(A)) = r(A)$

### 3. 最小二乘问题

当 $r(A) < r(A|b)$ 时，虽然方程组无解，但可以找到使 $\|Ax - b\|$ 最小的 $x$，这就是最小二乘解。

### 4. 数值稳定性

实际计算中，由于舍入误差，判断 $r(A) = r(A|b)$ 需要设定容差。

## ⚠️ 易错提醒

### 1. 秩的计算

- 必须将矩阵化为行阶梯形
- 注意不要遗漏任何非零行
- 小心计算错误导致秩判断错误

### 2. 增广矩阵

- $(A|b)$ 的秩可能比 $A$ 的秩大1
- 不可能大于1以上
- 相等时方程组有解

### 3. 特殊情况

- 齐次方程组：永远相容（$b = 0$）
- 零矩阵：需要特别注意常数项

### 4. 理论理解

- 相容性是存在性问题
- 唯一性需要进一步判断 $r(A)$ 与 $n$ 的关系

## 📋 总结提升

### 核心要点

1. 相容性定理是方程组理论的基石
2. $r(A) = r(A|b)$ 是有解的充要条件
3. 秩的概念统一了各种判定方法
4. 几何上对应向量的线性表示问题

### 定理应用流程

```
线性方程组 Ax = b
        ↓
    计算 r(A) 和 r(A|b)
        ↓
    比较两个秩
        ↓
r(A) = r(A|b)? ——否——> 无解（不相容）
    ↓是
  有解（相容）
    ↓
进一步判断解的个数
```

### 知识网络

```
相容性定理
├── 理论基础
│   ├── 矩阵的秩
│   ├── 向量的线性表示
│   └── 列空间
├── 判定方法
│   ├── 秩的比较
│   ├── 行列式（方阵）
│   └── 向量方法
└── 应用
    ├── 解的存在性
    ├── 参数讨论
    └── 最小二乘
```

## 🔗 相关链接

- 秩的概念：[[3-4-1 向量组秩的定义]]
- 具体判定：[[4-2-1 齐次方程组解的判定]]、[[4-2-2 非齐次方程组解的判定]]
- 解的结构：[[4-3-1 齐次方程组解的性质]]
- 计算方法：[[4-1-2 高斯消元法]]

---

*相容性定理——方程组理论的定海神针！*