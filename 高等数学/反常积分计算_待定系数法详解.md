# 反常积分计算 - 分部积分与待定系数法详解

## 题目
计算 $\int_1^{+\infty} \frac{\arctan x}{x^2} dx$

## 解法分析

### 第一步：分部积分
使用分部积分公式：$\int udv = uv - \int vdu$

设：
- $u = \arctan x$，则 $du = \frac{1}{1+x^2}dx$
- $dv = \frac{1}{x^2}dx$，则 $v = -\frac{1}{x}$

因此：
$$\int_1^{+\infty} \frac{\arctan x}{x^2} dx = \left[-\frac{1}{x}\arctan x\right]_1^{+\infty} + \int_1^{+\infty} \frac{1}{x(x^2+1)}dx$$

### 第二步：计算第一项的极限
$$\left[-\frac{1}{x}\arctan x\right]_1^{+\infty} = \lim_{b \to +\infty}\left(-\frac{1}{b}\arctan b\right) - \left(-\frac{1}{1}\arctan 1\right)$$

当 $b \to +\infty$ 时：
- $\arctan b \to \frac{\pi}{2}$
- $\frac{1}{b} \to 0$
- 因此 $-\frac{1}{b}\arctan b \to 0$

所以第一项 = $0 - (-1 \cdot \frac{\pi}{4}) = \frac{\pi}{4}$

## 重点一：待定系数法（部分分式分解）

### 原理说明
对于分式 $\frac{1}{x(x^2+1)}$，我们要将其分解为简单分式的和。

### 设定形式
$$\frac{1}{x(x^2+1)} = \frac{A}{x} + \frac{Bx+C}{x^2+1}$$

注意：
- 分母 $x$ 是一次因式，对应分子是常数 $A$
- 分母 $x^2+1$ 是二次因式，对应分子是一次式 $Bx+C$

### 求解系数的方法
#### 方法1：通分比较系数
两边同时乘以 $x(x^2+1)$：
$$1 = A(x^2+1) + (Bx+C)x$$
$$1 = Ax^2 + A + Bx^2 + Cx$$
$$1 = (A+B)x^2 + Cx + A$$

比较系数：
- $x^2$ 系数：$A + B = 0$ 
- $x$ 系数：$C = 0$
- 常数项：$A = 1$

解得：$A = 1, B = -1, C = 0$

#### 方法2：赋值法（更快捷）
在等式 $\frac{1}{x(x^2+1)} = \frac{A}{x} + \frac{Bx+C}{x^2+1}$ 两边同乘 $x(x^2+1)$：
$$1 = A(x^2+1) + (Bx+C)x$$

**技巧：代入特殊值**
- 令 $x = 0$：$1 = A(0+1) + 0 = A$，得 $A = 1$
- 令 $x = i$（虚数单位）：$1 = 0 + (Bi+C)i = -B + Ci$
  由于左边是实数1，右边虚部必须为0，所以 $C = 0$，$B = -1$

### 最终分解结果
$$\frac{1}{x(x^2+1)} = \frac{1}{x} - \frac{x}{x^2+1}$$

验证：
$$\frac{1}{x} - \frac{x}{x^2+1} = \frac{x^2+1-x^2}{x(x^2+1)} = \frac{1}{x(x^2+1)}$$ ✓

## 重点二：两个无穷的极限为什么能抵消？

### 问题背景
在计算 $\int_1^{+\infty} \left(\frac{1}{x} - \frac{x}{1+x^2}\right)dx$ 时：
$$= \lim_{b \to +\infty}\left[\ln b - \frac{1}{2}\ln(1+b^2) + \frac{1}{2}\ln 2\right]$$

### 关键变形：使用对数运算法则
$$\ln b - \frac{1}{2}\ln(1+b^2) = \ln b - \ln\sqrt{1+b^2} = \ln\frac{b}{\sqrt{1+b^2}}$$
### 极限计算
当 $b \to +\infty$ 时：
$$\lim_{b \to +\infty} \ln\frac{b}{\sqrt{1+b^2}} = \lim_{b \to +\infty} \ln\frac{b}{b\sqrt{1+\frac{1}{b^2}}} = \lim_{b \to +\infty} \ln\frac{1}{\sqrt{1+\frac{1}{b^2}}}$$

因为 $\lim_{b \to +\infty} \frac{1}{b^2} = 0$，所以：
$$= \ln\frac{1}{\sqrt{1+0}} = \ln 1 = 0$$

### 深层理解：为什么能抵消？

**本质原因**：两个无穷大的增长速度相同！

1. **直观理解**：
   - $\ln b$ 当 $b \to +\infty$ 时趋于无穷
   - $\frac{1}{2}\ln(1+b^2) = \ln\sqrt{1+b^2}$ 也趋于无穷
   - 但是 $\sqrt{1+b^2} \approx b$ 当 $b$ 很大时（因为1相对于$b^2$可忽略）

2. **渐近分析**：
   当 $b \to +\infty$ 时：
   $$\sqrt{1+b^2} = b\sqrt{1+\frac{1}{b^2}} \approx b\left(1+\frac{1}{2b^2}+O(\frac{1}{b^4})\right) \approx b$$
   
   因此：
   $$\ln b - \ln\sqrt{1+b^2} \approx \ln b - \ln b = 0$$

3. **关键洞察**：
   这不是简单的"∞ - ∞"不定式，而是两个以**完全相同速度**增长的无穷大相减。
   
   类比：就像两辆以相同速度行驶的火车，虽然都在前进（趋于无穷），但它们之间的距离（差值）保持不变（趋于0）。

## 第三步：完整计算

将所有部分组合：
$$\int_1^{+\infty} \frac{\arctan x}{x^2} dx = \frac{\pi}{4} + \int_1^{+\infty} \left(\frac{1}{x} - \frac{x}{1+x^2}\right)dx$$

$$= \frac{\pi}{4} + \lim_{b \to +\infty}\left[\ln b - \frac{1}{2}\ln(1+b^2) + \frac{1}{2}\ln 2\right]$$

$$= \frac{\pi}{4} + 0 + \frac{1}{2}\ln 2 = \frac{\pi}{4} + \frac{\ln 2}{2}$$
## 待定系数法使用指南（总结）

### 一般步骤

1. **观察分母的因式分解**
   - 一次因式 $(x-a)$ → 对应 $\frac{A}{x-a}$
   - 重复一次因式 $(x-a)^n$ → 对应 $\frac{A_1}{x-a} + \frac{A_2}{(x-a)^2} + \cdots + \frac{A_n}{(x-a)^n}$
   - 二次不可约因式 $(ax^2+bx+c)$ → 对应 $\frac{Bx+C}{ax^2+bx+c}$

2. **设定待定形式**
   根据分母的因式，写出部分分式的一般形式

3. **求解系数**
   - 方法A：通分后比较系数
   - 方法B：代入特殊值（包括虚数）
   - 方法C：极限法（对重复因式有效）

4. **验证结果**
   将分解后的式子通分，检验是否等于原式

### 常见题型示例

#### 例1：简单分式
$$\frac{1}{x^2-1} = \frac{1}{(x-1)(x+1)} = \frac{A}{x-1} + \frac{B}{x+1}$$

代入 $x=1$：$\frac{1}{2} = A$
代入 $x=-1$：$-\frac{1}{2} = B$

#### 例2：含二次项
$$\frac{2x+3}{x(x^2+4)} = \frac{A}{x} + \frac{Bx+C}{x^2+4}$$

代入 $x=0$：$\frac{3}{4} = A$
比较 $x^2$ 系数：$0 = A + B$，得 $B = -\frac{3}{4}$
比较 $x$ 系数：$2 = C$

## 易错点提醒

⚠️ **分母有二次不可约因式时**，分子必须设为一次式（$Bx+C$），而不是常数！

⚠️ **计算极限时**，要识别"同阶无穷大相减"的情形，通过因式分解或对数运算化简。

⚠️ **验证很重要**！分解后一定要通分验证是否正确。

---
*创建时间：2025-01-18*
*标签：#反常积分 #待定系数法 #部分分式分解 #极限计算*