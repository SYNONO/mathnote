# 全微分方程

#数学二 #高等数学 #第六章 #常微分方程 #一阶微分方程 #全微分方程

## 🏷️ 标签体系
- **L1知识点**：`全微分方程` `恰当方程` `积分因子` `全微分判定`
- **L2方法**：`直接积分法` `积分因子法` `偏积分法` `凑微分法`
- **L3章节**：`常微分方程`
- **难度**：`hard`

## 📖 定义

形如
$$M(x,y)dx + N(x,y)dy = 0$$
的方程，如果存在二元函数 $u(x,y)$ 使得
$$du = M(x,y)dx + N(x,y)dy$$
则称该方程为**全微分方程**（恰当方程）。

### 💡 理解要点
- 左端恰好是某个函数的全微分
- 通解为 $u(x,y) = C$
- 并非所有形式的方程都是全微分方程

## 一、全微分方程的判定

### 🔑 判定定理

方程 $M(x,y)dx + N(x,y)dy = 0$ 是全微分方程的**充要条件**是：
$$\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$$

**证明概要**：
- 若 $du = Mdx + Ndy$，则 $M = \frac{\partial u}{\partial x}$，$N = \frac{\partial u}{\partial y}$
- 由混合偏导数相等：$\frac{\partial^2 u}{\partial y \partial x} = \frac{\partial^2 u}{\partial x \partial y}$
- 得到判定条件

### 📐 例题6.22（判定是否为全微分方程）
判断方程 $(3x^2 + 6xy^2)dx + (6x^2y + 4y^3)dy = 0$ 是否为全微分方程。

**解**：
这里 $M = 3x^2 + 6xy^2$，$N = 6x^2y + 4y^3$

计算偏导数：
- $\frac{\partial M}{\partial y} = 12xy$
- $\frac{\partial N}{\partial x} = 12xy$

因为 $\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$，所以这是全微分方程。

## 二、全微分方程的求解

### 🔑 方法一：偏积分法

**步骤**：
1. 由 $\frac{\partial u}{\partial x} = M(x,y)$，对 $x$ 积分：
   $$u = \int M(x,y)dx + \varphi(y)$$
   其中 $\varphi(y)$ 是待定函数

2. 由 $\frac{\partial u}{\partial y} = N(x,y)$，求导：
   $$\frac{\partial}{\partial y}\left[\int M(x,y)dx\right] + \varphi'(y) = N(x,y)$$

3. 解出 $\varphi'(y)$，积分得 $\varphi(y)$

4. 通解为 $u(x,y) = C$

### 📐 例题6.23（偏积分法）
求解方程 $(3x^2 + 6xy^2)dx + (6x^2y + 4y^3)dy = 0$。

**解**：
已验证这是全微分方程。

1. 由 $\frac{\partial u}{\partial x} = 3x^2 + 6xy^2$，对 $x$ 积分：
   $$u = x^3 + 3x^2y^2 + \varphi(y)$$

2. 求 $\frac{\partial u}{\partial y}$：
   $$\frac{\partial u}{\partial y} = 6x^2y + \varphi'(y)$$

3. 由 $\frac{\partial u}{\partial y} = N = 6x^2y + 4y^3$：
   $$6x^2y + \varphi'(y) = 6x^2y + 4y^3$$
   
   得：$\varphi'(y) = 4y^3$

4. 积分：$\varphi(y) = y^4 + C_1$

5. 故 $u = x^3 + 3x^2y^2 + y^4 + C_1$

6. 通解为：$x^3 + 3x^2y^2 + y^4 = C$（$C$ 为任意常数）

### 🔑 方法二：凑微分法

对于某些特殊形式，可以直接凑出全微分。

**常用的全微分公式**：
- $d(xy) = ydx + xdy$
- $d\left(\frac{x}{y}\right) = \frac{ydx - xdy}{y^2}$
- $d\left(\frac{y}{x}\right) = \frac{xdy - ydx}{x^2}$
- $d(\ln|xy|) = \frac{dx}{x} + \frac{dy}{y}$
- $d\left(\arctan\frac{y}{x}\right) = \frac{xdy - ydx}{x^2 + y^2}$

### 📐 例题6.24（凑微分法）
求解方程 $ydx + xdy = 0$。

**解**：
注意到 $ydx + xdy = d(xy)$

所以方程化为 $d(xy) = 0$

通解为：$xy = C$

### 📐 例题6.25（综合应用）
求解方程 $(2xy + y^2)dx + (x^2 + 2xy)dy = 0$。

**解**：
1. 验证是否为全微分方程：
   - $M = 2xy + y^2$，$\frac{\partial M}{\partial y} = 2x + 2y$
   - $N = x^2 + 2xy$，$\frac{\partial N}{\partial x} = 2x + 2y$
   
   相等，是全微分方程。

2. 用凑微分法：
   $(2xy + y^2)dx + (x^2 + 2xy)dy$
   $= 2xy(dx + dy) + y^2dx + x^2dy$
   $= d(x^2y) + d(xy^2)$
   $= d(x^2y + xy^2)$
   $= d(xy(x + y))$

3. 通解为：$xy(x + y) = C$

## 三、积分因子

### 🔑 积分因子的概念

如果方程 $M(x,y)dx + N(x,y)dy = 0$ 不是全微分方程，但存在函数 $\mu(x,y) \neq 0$ 使得
$$\mu(x,y)M(x,y)dx + \mu(x,y)N(x,y)dy = 0$$
成为全微分方程，则称 $\mu(x,y)$ 为原方程的**积分因子**。

### 🔑 积分因子的求法

**1. 只与 $x$ 有关的积分因子**

若 $\frac{\frac{\partial M}{\partial y} - \frac{\partial N}{\partial x}}{N} = f(x)$（只与 $x$ 有关），则存在积分因子：
$$\mu(x) = e^{\int f(x)dx}$$

**2. 只与 $y$ 有关的积分因子**

若 $\frac{\frac{\partial N}{\partial x} - \frac{\partial M}{\partial y}}{M} = g(y)$（只与 $y$ 有关），则存在积分因子：
$$\mu(y) = e^{\int g(y)dy}$$

### 📐 例题6.26（求积分因子）
求解方程 $(3xy + y^2)dx + (x^2 + xy)dy = 0$。

**解**：
1. 检验是否为全微分方程：
   - $M = 3xy + y^2$，$\frac{\partial M}{\partial y} = 3x + 2y$
   - $N = x^2 + xy$，$\frac{\partial N}{\partial x} = 2x + y$
   
   $\frac{\partial M}{\partial y} \neq \frac{\partial N}{\partial x}$，不是全微分方程。

2. 寻找积分因子：
   $$\frac{\frac{\partial M}{\partial y} - \frac{\partial N}{\partial x}}{N} = \frac{(3x + 2y) - (2x + y)}{x^2 + xy} = \frac{x + y}{x(x + y)} = \frac{1}{x}$$
   
   只与 $x$ 有关，故积分因子为：
   $$\mu(x) = e^{\int \frac{1}{x}dx} = e^{\ln|x|} = x$$

3. 乘以积分因子：
   $$x(3xy + y^2)dx + x(x^2 + xy)dy = 0$$
   $$(3x^2y + xy^2)dx + (x^3 + x^2y)dy = 0$$

4. 验证新方程为全微分方程，求解得通解为：
   $$x^3y + \frac{1}{2}x^2y^2 = C$$

## 四、特殊类型的全微分方程

### 🔑 可分离变量型

形如 $f(x)dx + g(y)dy = 0$ 的方程必为全微分方程。

通解：$\int f(x)dx + \int g(y)dy = C$

### 🔑 齐次函数型

若 $M(x,y)$ 和 $N(x,y)$ 都是 $n$ 次齐次函数，则：
- 积分因子可取为 $\mu = \frac{1}{xM + yN}$（当 $xM + yN \neq 0$ 时）

### 📐 例题6.27（初值问题）
求解初值问题：
$$\begin{cases}
(e^x\sin y + 2y)dx + (e^x\cos y + 2x)dy = 0 \\
y|_{x=0} = \pi
\end{cases}$$

**解**：
1. 验证全微分方程：
   - $\frac{\partial M}{\partial y} = e^x\cos y + 2$
   - $\frac{\partial N}{\partial x} = e^x\cos y + 2$
   
   相等，是全微分方程。

2. 求原函数：
   由 $\frac{\partial u}{\partial x} = e^x\sin y + 2y$：
   $$u = e^x\sin y + 2xy + \varphi(y)$$
   
   由 $\frac{\partial u}{\partial y} = e^x\cos y + 2x + \varphi'(y) = e^x\cos y + 2x$：
   $$\varphi'(y) = 0$$
   
   故 $\varphi(y) = C_1$

3. 通解：$e^x\sin y + 2xy = C$

4. 利用初值条件 $x = 0, y = \pi$：
   $$e^0\sin\pi + 2 \cdot 0 \cdot \pi = C$$
   $$0 = C$$

5. 特解：$e^x\sin y + 2xy = 0$

## 🎯 解题要点

1. **判定步骤**
   - 首先验证 $\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$
   - 相等则为全微分方程，不等则需寻找积分因子

2. **求解方法选择**
   - 简单形式用凑微分法
   - 一般形式用偏积分法
   - 不是全微分方程时先求积分因子

3. **积分因子的寻找**
   - 优先考虑只与 $x$ 或只与 $y$ 有关的情形
   - 利用特殊结构（如齐次性）

4. **验证答案**
   - 对通解求全微分，应得原方程
   - 初值问题要代入验证

## ⚠️ 易错提醒

1. **偏导数计算**
   - 务必仔细计算 $\frac{\partial M}{\partial y}$ 和 $\frac{\partial N}{\partial x}$
   - 注意偏导数的求法

2. **积分时的"常数"**
   - 对 $x$ 积分时，"常数"是 $y$ 的函数
   - 对 $y$ 积分时，"常数"是 $x$ 的函数

3. **积分因子**
   - 积分因子不唯一
   - 求出一个即可，不必求所有

4. **初值问题**
   - 代入初值求特解时注意计算准确
   - 有时需要隐函数形式的解

## 🔗 相关链接
- [[6-2-1 可分离变量的微分方程]]
- [[6-2-3 一阶线性微分方程]]
- [[6-3-1 可降阶的二阶微分方程]]

## 📝 总结
全微分方程是一类重要的一阶微分方程，其特点是方程左端恰好是某个二元函数的全微分。掌握判定条件和求解方法是关键，特别是偏积分法和积分因子法。在实际问题中，很多守恒量的变化都可以用全微分方程来描述。