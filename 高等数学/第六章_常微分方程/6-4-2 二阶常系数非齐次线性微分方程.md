# 二阶常系数非齐次线性微分方程

#数学二 #高等数学 #第六章 #常微分方程 #二阶线性方程 #非齐次方程

## 🏷️ 标签体系
- **L1知识点**：`非齐次方程` `特解` `待定系数法` `常数变易法` `解的结构`
- **L2方法**：`待定系数法` `类型判断` `特解设定` `共振处理`
- **L3章节**：`常微分方程`
- **难度**：`hard`

## 📖 定义

形如
$$y'' + py' + qy = f(x)$$
其中 $p, q$ 为常数，$f(x) \neq 0$ 的方程，称为**二阶常系数非齐次线性微分方程**。

### 💡 理解要点
- 与齐次方程相比，右端多了非零项 $f(x)$
- $f(x)$ 称为自由项或非齐次项
- 求解关键是找特解

## 一、解的结构

### 🔑 非齐次方程解的结构定理

**定理**：非齐次方程的通解 = 对应齐次方程的通解 + 非齐次方程的一个特解

即：若 $Y$ 是非齐次方程的通解，$y_c$ 是对应齐次方程的通解，$y_p$ 是非齐次方程的一个特解，则：
$$Y = y_c + y_p = C_1y_1 + C_2y_2 + y_p$$

### 🔑 叠加原理

若 $y_1^*$ 是方程 $y'' + py' + qy = f_1(x)$ 的特解，$y_2^*$ 是方程 $y'' + py' + qy = f_2(x)$ 的特解，则 $y_1^* + y_2^*$ 是方程 $y'' + py' + qy = f_1(x) + f_2(x)$ 的特解。

## 二、待定系数法

### 🔑 适用条件

当 $f(x)$ 具有特殊形式时，可以根据 $f(x)$ 的形式设定特解的形式，然后代入方程确定系数。

### 🔑 类型一：$f(x) = P_m(x)e^{\lambda x}$

其中 $P_m(x)$ 是 $m$ 次多项式。

**特解设定**：
$$y_p = x^k Q_m(x)e^{\lambda x}$$

其中：
- $Q_m(x)$ 是待定的 $m$ 次多项式
- $k$ 的取值：
  - 若 $\lambda$ 不是特征根，则 $k = 0$
  - 若 $\lambda$ 是单特征根，则 $k = 1$
  - 若 $\lambda$ 是重特征根，则 $k = 2$

### 📐 例题6.41（$\lambda$ 不是特征根）
求方程 $y'' - 3y' + 2y = e^{3x}$ 的通解。

**解**：
1. 齐次方程 $y'' - 3y' + 2y = 0$
   - 特征方程：$r^2 - 3r + 2 = 0$
   - 特征根：$r_1 = 1, r_2 = 2$
   - 齐次通解：$y_c = C_1e^x + C_2e^{2x}$

2. 设特解 $y_p = Ae^{3x}$（因为 $\lambda = 3$ 不是特征根）
   - $y_p' = 3Ae^{3x}$
   - $y_p'' = 9Ae^{3x}$
   
3. 代入原方程：
   $9Ae^{3x} - 9Ae^{3x} + 2Ae^{3x} = e^{3x}$
   $2Ae^{3x} = e^{3x}$
   $A = \frac{1}{2}$

4. 通解：$y = C_1e^x + C_2e^{2x} + \frac{1}{2}e^{3x}$

### 📐 例题6.42（$\lambda$ 是单特征根）
求方程 $y'' - 3y' + 2y = e^x$ 的通解。

**解**：
1. 齐次通解同上：$y_c = C_1e^x + C_2e^{2x}$

2. 因为 $\lambda = 1$ 是单特征根，设特解 $y_p = Axe^x$
   - $y_p' = A(x+1)e^x$
   - $y_p'' = A(x+2)e^x$

3. 代入原方程：
   $A(x+2)e^x - 3A(x+1)e^x + 2Axe^x = e^x$
   $A[x+2-3(x+1)+2x]e^x = e^x$
   $A[x+2-3x-3+2x]e^x = e^x$
   $-Ae^x = e^x$
   $A = -1$

4. 通解：$y = C_1e^x + C_2e^{2x} - xe^x$

### 🔑 类型二：$f(x) = e^{\alpha x}[P_l(x)\cos\beta x + P_n(x)\sin\beta x]$

**特解设定**：
$$y_p = x^k e^{\alpha x}[Q_m(x)\cos\beta x + R_m(x)\sin\beta x]$$

其中：
- $m = \max(l, n)$
- $Q_m(x), R_m(x)$ 是待定的 $m$ 次多项式
- $k$ 的取值：
  - 若 $\alpha + i\beta$ 不是特征根，则 $k = 0$
  - 若 $\alpha + i\beta$ 是特征根，则 $k = 1$

### 📐 例题6.43（三角函数型）
求方程 $y'' + y = \sin x$ 的通解。

**解**：
1. 齐次方程 $y'' + y = 0$
   - 特征根：$r = \pm i$
   - 齐次通解：$y_c = C_1\cos x + C_2\sin x$

2. 因为 $\alpha = 0, \beta = 1$，而 $i$ 是特征根，设特解：
   $y_p = x(A\cos x + B\sin x)$

3. 计算导数：
   - $y_p' = (A\cos x + B\sin x) + x(-A\sin x + B\cos x)$
   - $y_p'' = 2(-A\sin x + B\cos x) + x(-A\cos x - B\sin x)$

4. 代入原方程并比较系数：
   得 $A = -\frac{1}{2}, B = 0$

5. 通解：$y = C_1\cos x + C_2\sin x - \frac{1}{2}x\cos x$

### 📐 例题6.44（多项式型）
求方程 $y'' - 2y' + y = x^2 + 1$ 的通解。

**解**：
1. 齐次方程：特征根 $r = 1$（二重根）
   齐次通解：$y_c = (C_1 + C_2x)e^x$

2. 设特解 $y_p = ax^2 + bx + c$（$\lambda = 0$ 不是特征根）
   - $y_p' = 2ax + b$
   - $y_p'' = 2a$

3. 代入：$2a - 2(2ax + b) + ax^2 + bx + c = x^2 + 1$
   整理：$ax^2 + (b-4a)x + (2a-2b+c) = x^2 + 1$

4. 比较系数：
   - $x^2$：$a = 1$
   - $x^1$：$b - 4a = 0 \Rightarrow b = 4$
   - $x^0$：$2a - 2b + c = 1 \Rightarrow c = 7$

5. 通解：$y = (C_1 + C_2x)e^x + x^2 + 4x + 7$

## 三、常见类型总结

### 🔑 特解设定规则表

| $f(x)$ 的形式 | 特解 $y_p$ 的设定 | $k$ 的确定 |
|---|---|---|
| $P_m(x)$ | $x^k Q_m(x)$ | 0不是特征根：$k=0$<br>0是单根：$k=1$<br>0是重根：$k=2$ |
| $P_m(x)e^{\lambda x}$ | $x^k Q_m(x)e^{\lambda x}$ | $\lambda$不是特征根：$k=0$<br>$\lambda$是单根：$k=1$<br>$\lambda$是重根：$k=2$ |
| $P_m(x)\cos\beta x$<br>或 $P_m(x)\sin\beta x$ | $x^k[Q_m(x)\cos\beta x + R_m(x)\sin\beta x]$ | $\pm i\beta$不是特征根：$k=0$<br>$\pm i\beta$是特征根：$k=1$ |
| $e^{\alpha x}P_m(x)\cos\beta x$<br>或 $e^{\alpha x}P_m(x)\sin\beta x$ | $x^k e^{\alpha x}[Q_m(x)\cos\beta x + R_m(x)\sin\beta x]$ | $\alpha\pm i\beta$不是特征根：$k=0$<br>$\alpha\pm i\beta$是特征根：$k=1$ |

### 📐 例题6.45（综合应用）
求方程 $y'' - 2y' + y = xe^x + \cos x$ 的通解。

**解**：
1. 齐次通解：$y_c = (C_1 + C_2x)e^x$

2. 利用叠加原理，分别求特解：
   
   **对于 $xe^x$**：
   - $\lambda = 1$ 是二重根，设 $y_{p1} = x^2(ax + b)e^x$
   - 代入求得：$y_{p1} = \frac{1}{6}x^3e^x$
   
   **对于 $\cos x$**：
   - $\pm i$ 不是特征根，设 $y_{p2} = A\cos x + B\sin x$
   - 代入求得：$y_{p2} = 2\sin x$

3. 通解：$y = (C_1 + C_2x)e^x + \frac{1}{6}x^3e^x + 2\sin x$

## 四、共振现象

### 🔑 物理背景

当外力频率等于系统固有频率时，发生共振，振幅随时间线性增长。

### 📐 例题6.46（共振）
无阻尼弹簧振子在周期外力作用下：
$$\frac{d^2x}{dt^2} + \omega_0^2 x = F_0\cos\omega_0 t$$

**解**：
1. 特征根：$r = \pm i\omega_0$
   齐次通解：$x_c = C_1\cos\omega_0 t + C_2\sin\omega_0 t$

2. 因为 $i\omega_0$ 是特征根（共振情形），设：
   $x_p = t(A\cos\omega_0 t + B\sin\omega_0 t)$

3. 代入求得：$A = 0, B = \frac{F_0}{2\omega_0}$

4. 通解：$x = C_1\cos\omega_0 t + C_2\sin\omega_0 t + \frac{F_0}{2\omega_0}t\sin\omega_0 t$

振幅随时间 $t$ 线性增长！

## 🎯 解题策略

1. **求齐次通解**
   - 先解对应的齐次方程
   - 确定特征根

2. **设定特解形式**
   - 根据 $f(x)$ 的类型
   - 判断是否与特征根重合
   - 确定 $k$ 的值

3. **待定系数**
   - 将设定的特解代入原方程
   - 比较系数确定待定常数

4. **写出通解**
   - 齐次通解 + 特解

## ⚠️ 易错提醒

1. **特解设定**
   - 必须包含完整的形式
   - 三角函数必须同时包含 $\cos$ 和 $\sin$

2. **重根判断**
   - 要准确判断 $\lambda$ 或 $\alpha \pm i\beta$ 是否为特征根
   - 重根时要乘以相应的 $x^k$

3. **系数确定**
   - 代入时计算要仔细
   - 比较系数时不要遗漏

4. **叠加原理**
   - 复杂的 $f(x)$ 可以分解求解
   - 最后将特解相加

## 🔗 相关链接
- [[6-4-1 二阶常系数齐次线性微分方程]]
- [[6-5-1 微分方程的应用]]
- [[6-6 第六章总结]]

## 📝 总结
二阶常系数非齐次线性微分方程的求解关键是掌握待定系数法。根据自由项的形式正确设定特解形式，特别注意共振情形（特征根重合）需要乘以 $x^k$。这类方程在物理和工程中描述受迫振动等现象。