# 条件极值

#数学二 #高等数学 #第四章 #多元函数微分学 #条件极值 #拉格朗日乘数法

## 🏷️ 标签体系
- **L1知识点**：`条件极值` `拉格朗日乘数法` `约束条件` `Lagrange函数`
- **L2方法**：`拉格朗日乘数法` `代入法` `参数法`
- **L3章节**：`多元函数微分学`
- **难度**：`expert`

## 📖 定义/概念

### 条件极值
在满足一定条件（约束条件）下求函数的极值，称为**条件极值**。

一般形式：
$$\begin{aligned}
&\text{目标：} &&\min/\max \quad f(x, y) \\
&\text{约束：} &&\varphi(x, y) = 0
\end{aligned}$$

### 💡 理解要点
1. 无条件极值：在整个定义域内求极值
2. 条件极值：在满足约束条件的点集上求极值
3. 约束条件限定了搜索范围

## 一、拉格朗日乘数法

### 🔑 基本原理
对于约束优化问题：
$$\begin{cases}
\text{目标函数：} z = f(x, y) \\
\text{约束条件：} \varphi(x, y) = 0
\end{cases}$$

构造**拉格朗日函数**：
$$L(x, y, \lambda) = f(x, y) + \lambda \varphi(x, y)$$

其中 $\lambda$ 称为**拉格朗日乘数**。

### 必要条件
若 $(x_0, y_0)$ 是条件极值点，则存在 $\lambda_0$，使得：
$$\begin{cases}
L_x = f_x + \lambda \varphi_x = 0 \\
L_y = f_y + \lambda \varphi_y = 0 \\
L_\lambda = \varphi(x, y) = 0
\end{cases}$$

### 📐 例题4.61（基本应用）
求函数 $z = xy$ 在条件 $x + y = 1$ 下的极值。

**解**：
1. 构造拉格朗日函数：
   $$L = xy + \lambda(x + y - 1)$$

2. 求偏导数并令其为零：
   $$\begin{cases}
   L_x = y + \lambda = 0 \\
   L_y = x + \lambda = 0 \\
   L_\lambda = x + y - 1 = 0
   \end{cases}$$

3. 解方程组：
   从前两式得 $y = -\lambda$，$x = -\lambda$
   代入第三式：$-2\lambda = 1$，得 $\lambda = -\frac{1}{2}$
   
4. 因此：$x = y = \frac{1}{2}$，极值为 $z = \frac{1}{4}$

## 二、几何解释

### 🔑 梯度平行原理
在条件极值点处，目标函数的梯度与约束条件的梯度平行：
$$\nabla f = -\lambda \nabla \varphi$$

这解释了为什么拉格朗日乘数法有效。

### 📐 例题4.62（几何意义）
求点 $(3, 0)$ 到直线 $x + y - 1 = 0$ 的最短距离。

**解**：
目标函数：$f(x,y) = (x-3)^2 + y^2$（距离的平方）
约束条件：$\varphi(x,y) = x + y - 1 = 0$

1. 拉格朗日函数：
   $$L = (x-3)^2 + y^2 + \lambda(x + y - 1)$$

2. 必要条件：
   $$\begin{cases}
   2(x-3) + \lambda = 0 \\
   2y + \lambda = 0 \\
   x + y - 1 = 0
   \end{cases}$$

3. 解得：$x = 2$，$y = -1$，$\lambda = 2$

4. 最短距离：$d = \sqrt{(2-3)^2 + (-1)^2} = \sqrt{2}$

## 三、多个约束条件

### 问题形式
$$\begin{aligned}
&\text{目标：} &&f(x, y, z) \\
&\text{约束：} &&\begin{cases}
\varphi_1(x, y, z) = 0 \\
\varphi_2(x, y, z) = 0
\end{cases}
\end{aligned}$$

### 拉格朗日函数
$$L = f(x, y, z) + \lambda_1 \varphi_1(x, y, z) + \lambda_2 \varphi_2(x, y, z)$$

### 📐 例题4.63（两个约束）
求函数 $u = xyz$ 在条件 $\begin{cases} x + y + z = 3 \\ x^2 + y^2 + z^2 = 3 \end{cases}$ 下的极值。

**解**：
1. 拉格朗日函数：
   $$L = xyz + \lambda_1(x + y + z - 3) + \lambda_2(x^2 + y^2 + z^2 - 3)$$

2. 必要条件：
   $$\begin{cases}
   yz + \lambda_1 + 2\lambda_2 x = 0 \\
   xz + \lambda_1 + 2\lambda_2 y = 0 \\
   xy + \lambda_1 + 2\lambda_2 z = 0 \\
   x + y + z = 3 \\
   x^2 + y^2 + z^2 = 3
   \end{cases}$$

3. 由对称性，猜测 $x = y = z = 1$
   验证：满足两个约束条件
   
4. 极值：$u = 1$

## 四、实际应用

### 1. 经济学应用
在预算约束下最大化效用。

### 📐 例题4.64（预算约束）
消费者效用函数为 $U = x^{0.6}y^{0.4}$，商品价格分别为 $p_1 = 3$，$p_2 = 2$，
预算为 $M = 120$，求最优消费组合。

**解**：
约束条件：$3x + 2y = 120$

1. 拉格朗日函数：
   $$L = x^{0.6}y^{0.4} + \lambda(120 - 3x - 2y)$$

2. 必要条件：
   $$\begin{cases}
   0.6x^{-0.4}y^{0.4} - 3\lambda = 0 \\
   0.4x^{0.6}y^{-0.6} - 2\lambda = 0 \\
   3x + 2y = 120
   \end{cases}$$

3. 从前两式得：
   $$\frac{0.6y}{x} = \frac{3\lambda}{y^{0.6}/x^{0.4}}$$
   $$\frac{0.4x}{y} = \frac{2\lambda}{x^{0.6}/y^{0.6}}$$
   
   简化得：$\frac{0.6y}{3x} = \frac{0.4x}{2y}$
   
4. 解得：$x = 24$，$y = 24$

### 2. 几何应用
在曲线或曲面上求最值点。

## 五、其他方法

### 1. 代入法
将约束条件解出一个变量，代入目标函数，化为无条件极值。

### 2. 参数法
用参数方程表示约束条件。

### 📐 例题4.65（代入法）
用代入法重做例题4.61。

**解**：
由 $x + y = 1$ 得 $y = 1 - x$
代入目标函数：$z = x(1-x) = x - x^2$

求导：$z' = 1 - 2x = 0$
得 $x = \frac{1}{2}$，$y = \frac{1}{2}$

## 🎯 易错提醒

1. **乘数的符号**：可以用 $+\lambda$ 或 $-\lambda$，但要保持一致
2. **必要条件**：求得的点不一定是极值点，需要进一步判断
3. **边界情况**：实际问题中要考虑变量的取值范围
4. **多解情况**：可能有多个候选点，需要比较函数值

## 🔗 相关链接
- [[4-5-2 多元函数的极值]] - 无条件极值
- [[4-4-4 隐函数组]] - 约束条件的处理
- [[4-5-1 方向导数与梯度]] - 梯度的应用
- [[线性规划]] - 线性约束优化

## 🔗 相关题目练习
根据标签可在题库中搜索：
- 知识点标签：`条件极值` `拉格朗日乘数法`
- 章节标签：`多元函数微分学`
- 难度：`expert`