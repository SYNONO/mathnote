# 多元函数的极值

#数学二 #高等数学 #第四章 #多元函数微分学 #极值

## 🏷️ 标签体系
- **L1知识点**：`多元函数极值` `极值判定` `驻点` `Hessian矩阵`
- **L2方法**：`必要条件法` `充分条件法` `二阶判别法`
- **L3章节**：`多元函数微分学`
- **难度**：`hard`

## 📖 定义/概念

### 极值的定义
设函数 $z = f(x,y)$ 在点 $(x_0, y_0)$ 的某邻域内有定义，如果对于该邻域内任意异于 $(x_0, y_0)$ 的点 $(x, y)$，都有：
- $f(x,y) < f(x_0, y_0)$，则称 $f(x_0, y_0)$ 为**极大值**
- $f(x,y) > f(x_0, y_0)$，则称 $f(x_0, y_0)$ 为**极小值**

极大值和极小值统称为**极值**，使函数取得极值的点称为**极值点**。

### 💡 理解要点
1. 极值是局部概念，不是全局概念
2. 极值点必须是内点（在定义域内部）
3. 边界点可能是最值点，但不是极值点

## 一、极值的必要条件

### 🔑 定理（Fermat定理推广）
若函数 $f(x,y)$ 在点 $(x_0, y_0)$ 处：
1. 取得极值
2. 偏导数存在

则必有：$f_x(x_0, y_0) = 0$，$f_y(x_0, y_0) = 0$

### 驻点
使 $f_x = 0$ 且 $f_y = 0$ 的点称为函数的**驻点**（或稳定点、临界点）。

⚠️ 注意：驻点不一定是极值点！

### 📐 例题4.56（寻找驻点）
求函数 $f(x,y) = x^3 + y^3 - 3xy$ 的驻点。

**解**：
1. 求偏导数：
   - $f_x = 3x^2 - 3y$
   - $f_y = 3y^2 - 3x$

2. 令偏导数为零：
   $$\begin{cases}
   3x^2 - 3y = 0 \\
   3y^2 - 3x = 0
   \end{cases}$$
   即
   $$\begin{cases}
   x^2 = y \\
   y^2 = x
   \end{cases}$$

3. 解方程组：
   由第一个方程代入第二个：$x^4 = x$
   得 $x(x^3 - 1) = 0$
   
4. 驻点为：$(0, 0)$ 和 $(1, 1)$

## 二、极值的充分条件

### 🔑 二阶判别法
设函数 $f(x,y)$ 在点 $(x_0, y_0)$ 的某邻域内具有二阶连续偏导数，且 $(x_0, y_0)$ 是驻点。记：
- $A = f_{xx}(x_0, y_0)$
- $B = f_{xy}(x_0, y_0)$
- $C = f_{yy}(x_0, y_0)$
- $\Delta = AC - B^2$（判别式）

则：
1. 若 $\Delta > 0$：
   - $A > 0$ 时，$(x_0, y_0)$ 是极小值点
   - $A < 0$ 时，$(x_0, y_0)$ 是极大值点
2. 若 $\Delta < 0$：$(x_0, y_0)$ 不是极值点（鞍点）
3. 若 $\Delta = 0$：无法判定，需要其他方法

### 📐 例题4.57（极值判定）
判定例题4.56中函数 $f(x,y) = x^3 + y^3 - 3xy$ 的驻点性质。

**解**：
1. 计算二阶偏导数：
   - $f_{xx} = 6x$
   - $f_{xy} = -3$
   - $f_{yy} = 6y$

2. 在驻点 $(0,0)$：
   - $A = 0$，$B = -3$，$C = 0$
   - $\Delta = 0 \cdot 0 - (-3)^2 = -9 < 0$
   - 因此 $(0,0)$ 是鞍点

3. 在驻点 $(1,1)$：
   - $A = 6$，$B = -3$，$C = 6$
   - $\Delta = 6 \cdot 6 - (-3)^2 = 36 - 9 = 27 > 0$
   - 且 $A = 6 > 0$
   - 因此 $(1,1)$ 是极小值点，极小值为 $f(1,1) = -1$

## 三、特殊情况的处理

### 1. $\Delta = 0$ 的情况
需要用高阶导数或定义判定。

### 📐 例题4.58（$\Delta = 0$ 的例子）
判定函数 $f(x,y) = x^4 + y^4$ 在原点的极值性。

**解**：
1. 显然 $(0,0)$ 是驻点
2. $A = C = 0$，$B = 0$，故 $\Delta = 0$
3. 但由定义：$f(x,y) = x^4 + y^4 \geq 0 = f(0,0)$
4. 因此 $(0,0)$ 是极小值点

### 2. 不可导点
需要用定义或其他方法判定。

## 四、多元函数极值的求解步骤

### 标准步骤
1. 求一阶偏导数 $f_x$、$f_y$
2. 解方程组 $\begin{cases} f_x = 0 \\ f_y = 0 \end{cases}$，得到驻点
3. 求二阶偏导数 $f_{xx}$、$f_{xy}$、$f_{yy}$
4. 对每个驻点计算判别式 $\Delta = AC - B^2$
5. 根据判别法则判定极值

### 📐 例题4.59（完整求极值）
求函数 $f(x,y) = x^2 + y^2 + 2x - 4y + 5$ 的极值。

**解**：
1. 一阶偏导数：
   - $f_x = 2x + 2$
   - $f_y = 2y - 4$

2. 驻点：
   $\begin{cases} 2x + 2 = 0 \\ 2y - 4 = 0 \end{cases}$
   得驻点 $(-1, 2)$

3. 二阶偏导数：
   - $A = f_{xx} = 2$
   - $B = f_{xy} = 0$
   - $C = f_{yy} = 2$

4. 判别：
   $\Delta = 2 \cdot 2 - 0^2 = 4 > 0$，且 $A = 2 > 0$
   
5. 结论：$(-1, 2)$ 是极小值点，极小值为 $f(-1, 2) = 0$

## 五、实际应用

### 1. 最小二乘法
求使误差平方和最小的参数。

### 2. 经济学应用
利润最大化、成本最小化问题。

### 📐 例题4.60（应用题）
某工厂生产两种产品，产量分别为 $x$、$y$，利润函数为
$$P(x,y) = 100x + 150y - x^2 - 2y^2 - xy$$
求使利润最大的产量。

**解**：
1. $P_x = 100 - 2x - y = 0$
   $P_y = 150 - 4y - x = 0$

2. 解得：$x = 20$，$y = 30$

3. $A = -2$，$B = -1$，$C = -4$
   $\Delta = 8 - 1 = 7 > 0$，且 $A < 0$

4. 因此 $(20, 30)$ 是极大值点，最大利润为 $P(20, 30) = 2700$

## 🎯 易错提醒

1. **必要条件不充分**：驻点不一定是极值点
2. **边界问题**：极值必须在内点取得，边界点另行考虑
3. **判别式为零**：需要其他方法判定
4. **实际问题**：要验证求得的极值点符合实际意义

## 🔗 相关链接
- [[2-5-2 函数的极值]] - 一元函数极值
- [[4-5-1 方向导数与梯度]] - 梯度为零
- [[4-5-3 条件极值]] - 带约束的极值
- [[4-5-4 最值问题]] - 闭区域上的最值

## 🔗 相关题目练习
根据标签可在题库中搜索：
- 知识点标签：`多元函数极值` `驻点`
- 章节标签：`多元函数微分学`
- 难度：`hard`