# 链式法则

#数学二 #高等数学 #第四章 #多元函数微分学 #链式法则

## 🏷️ 标签体系
- **L1知识点**：`链式法则` `复合函数求导` `多元复合函数` `偏导数链式法则`
- **L2方法**：`树形图法` `公式法` `直接计算法`
- **L3章节**：`多元函数微分学`
- **难度**：`hard`

## 📖 定义/概念

### 链式法则的一般形式
设 $z = f(u_1, u_2, \cdots, u_m)$，其中 $u_i = g_i(x_1, x_2, \cdots, x_n)$（$i = 1, 2, \cdots, m$），
若各函数具有相应的可微性，则复合函数 $z = f(g_1, g_2, \cdots, g_m)$ 的偏导数为：
$$\frac{\partial z}{\partial x_j} = \sum_{i=1}^m \frac{\partial z}{\partial u_i} \cdot \frac{\partial u_i}{\partial x_j} \quad (j = 1, 2, \cdots, n)$$

### 💡 理解要点
1. 链式法则描述了复合函数求导的规律
2. 每条路径的贡献相乘，所有路径的贡献相加
3. 可以用树形图直观表示求导路径

## 一、常见情形的链式法则

### 情形1：$z = f(u, v)$，$u = u(x, y)$，$v = v(x, y)$
$$\frac{\partial z}{\partial x} = \frac{\partial z}{\partial u} \cdot \frac{\partial u}{\partial x} + \frac{\partial z}{\partial v} \cdot \frac{\partial v}{\partial x}$$
$$\frac{\partial z}{\partial y} = \frac{\partial z}{\partial u} \cdot \frac{\partial u}{\partial y} + \frac{\partial z}{\partial v} \cdot \frac{\partial v}{\partial y}$$

### 📐 例题4.35（基本链式法则）
设 $z = u^2 + v^2$，其中 $u = x + y$，$v = x - y$，求 $\frac{\partial z}{\partial x}$ 和 $\frac{\partial z}{\partial y}$。

**解**：
1. 先求 $z$ 对中间变量的偏导数：
   - $\frac{\partial z}{\partial u} = 2u = 2(x + y)$
   - $\frac{\partial z}{\partial v} = 2v = 2(x - y)$

2. 求中间变量对自变量的偏导数：
   - $\frac{\partial u}{\partial x} = 1$，$\frac{\partial u}{\partial y} = 1$
   - $\frac{\partial v}{\partial x} = 1$，$\frac{\partial v}{\partial y} = -1$

3. 应用链式法则：
   - $\frac{\partial z}{\partial x} = 2(x + y) \cdot 1 + 2(x - y) \cdot 1 = 4x$
   - $\frac{\partial z}{\partial y} = 2(x + y) \cdot 1 + 2(x - y) \cdot (-1) = 4y$

### 情形2：$z = f(u, v)$，$u = u(x)$，$v = v(x)$
$$\frac{dz}{dx} = \frac{\partial z}{\partial u} \cdot \frac{du}{dx} + \frac{\partial z}{\partial v} \cdot \frac{dv}{dx}$$

注意：此时 $z$ 是 $x$ 的一元函数，用全导数符号。

### 情形3：$z = f(x, y, u)$，$u = u(x, y)$
$$\frac{\partial z}{\partial x} = \frac{\partial f}{\partial x} + \frac{\partial f}{\partial u} \cdot \frac{\partial u}{\partial x}$$
$$\frac{\partial z}{\partial y} = \frac{\partial f}{\partial y} + \frac{\partial f}{\partial u} \cdot \frac{\partial u}{\partial y}$$

注意：$f$ 对 $x$ 的偏导数是把 $y$、$u$ 都看作常数。

## 二、树形图方法

### 🔑 树形图规则
1. 画出从因变量到自变量的所有路径
2. 每条路径上的偏导数相乘
3. 所有路径的结果相加

### 📐 例题4.36（用树形图求偏导）
设 $z = f(u, v, w)$，其中 $u = x^2$，$v = xy$，$w = y^2$，求 $\frac{\partial z}{\partial x}$。

**解**：
树形图：
```
       z
    /  |  \
   u   v   w
   |  / \  |
   x  x y  y
```

从 $z$ 到 $x$ 的路径：
1. $z \to u \to x$：贡献 $\frac{\partial z}{\partial u} \cdot \frac{\partial u}{\partial x} = f_u \cdot 2x$
2. $z \to v \to x$：贡献 $\frac{\partial z}{\partial v} \cdot \frac{\partial v}{\partial x} = f_v \cdot y$

因此：$\frac{\partial z}{\partial x} = 2xf_u + yf_v$

## 三、高阶偏导数的链式法则

### 📐 例题4.37（二阶偏导数）
设 $z = f(u, v)$，$u = x + y$，$v = xy$，其中 $f$ 具有二阶连续偏导数，求 $\frac{\partial^2 z}{\partial x^2}$。

**解**：
1. 先求一阶偏导数：
   $$\frac{\partial z}{\partial x} = f_u \cdot 1 + f_v \cdot y = f_u + yf_v$$

2. 再对 $x$ 求偏导：
   $$\frac{\partial^2 z}{\partial x^2} = \frac{\partial}{\partial x}(f_u + yf_v)$$
   
   注意 $f_u$ 和 $f_v$ 都是 $u$、$v$ 的函数，而 $u$、$v$ 又是 $x$、$y$ 的函数：
   
   $$\frac{\partial f_u}{\partial x} = f_{uu} \cdot 1 + f_{uv} \cdot y$$
   $$\frac{\partial (yf_v)}{\partial x} = y(f_{vu} \cdot 1 + f_{vv} \cdot y)$$

3. 因此：
   $$\frac{\partial^2 z}{\partial x^2} = f_{uu} + 2yf_{uv} + y^2f_{vv}$$

## 四、特殊情况

### 1. 含参数的复合函数
若 $z = f(x, y, t)$，其中 $x = x(t)$，$y = y(t)$，则：
$$\frac{dz}{dt} = \frac{\partial f}{\partial x} \cdot \frac{dx}{dt} + \frac{\partial f}{\partial y} \cdot \frac{dy}{dt} + \frac{\partial f}{\partial t}$$

### 2. 抽象函数的处理
当 $f$ 的具体形式未知时，常用下标表示偏导数：
- $f_1$ 表示 $f$ 对第一个变量的偏导数
- $f_{12}$ 表示先对第一个变量求偏导，再对第二个变量求偏导

### 📐 例题4.38（抽象函数）
设 $z = f(x^2 - y^2, e^{xy})$，求 $\frac{\partial z}{\partial x}$ 和 $\frac{\partial z}{\partial y}$。

**解**：
记 $u = x^2 - y^2$，$v = e^{xy}$，则 $z = f(u, v)$

1. 计算中间变量的偏导数：
   - $\frac{\partial u}{\partial x} = 2x$，$\frac{\partial u}{\partial y} = -2y$
   - $\frac{\partial v}{\partial x} = ye^{xy}$，$\frac{\partial v}{\partial y} = xe^{xy}$

2. 应用链式法则：
   - $\frac{\partial z}{\partial x} = f_1 \cdot 2x + f_2 \cdot ye^{xy} = 2xf_1 + ye^{xy}f_2$
   - $\frac{\partial z}{\partial y} = f_1 \cdot (-2y) + f_2 \cdot xe^{xy} = -2yf_1 + xe^{xy}f_2$

## 五、链式法则的应用技巧

### 1. 选择合适的中间变量
中间变量的选择影响计算的复杂度

### 2. 利用对称性
若函数具有对称性，可以简化计算

### 3. 验证结果
可以通过不同方法验证结果的正确性

## 🎯 易错提醒

1. **符号混淆**：分清偏导数 $\frac{\partial}{\partial x}$ 和全导数 $\frac{d}{dx}$
2. **路径遗漏**：确保考虑所有从因变量到自变量的路径
3. **高阶导数**：注意中间变量的函数也要继续求导
4. **抽象函数**：正确使用下标记号，如 $f_1$、$f_2$ 等

## 🔗 相关链接
- [[2-1-8 复合函数求导法则]] - 一元函数链式法则
- [[4-2-1 一阶偏导数的计算]] - 偏导数基础
- [[4-4-2 全导数]] - 特殊的链式法则
- [[4-4-3 隐函数求导法则]] - 链式法则的应用

## 🔗 相关题目练习
根据标签可在题库中搜索：
- 知识点标签：`链式法则` `复合函数求导`
- 章节标签：`多元函数微分学`
- 难度：`hard`