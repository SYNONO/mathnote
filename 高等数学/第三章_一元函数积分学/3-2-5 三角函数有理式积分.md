# 三角函数有理式积分

#数学二 #高等数学 #第三章 #一元函数积分学 #三角函数积分 #万能代换

## 🏷️ 标签体系
- **L1知识点**：`三角函数有理式积分` `万能代换` `三角恒等变换`
- **L2方法**：`万能代换法` `三角恒等式法` `特殊代换法`
- **L3章节**：`一元函数积分学`
- **难度**：`hard`

## 📖 定义/概念

三角函数有理式是指由 $\sin x$、$\cos x$ 及常数经过有限次四则运算得到的函数，记作 $R(\sin x, \cos x)$。

### 💡 基本思路
将三角函数有理式通过适当代换转化为普通有理函数，然后用有理函数积分方法求解。

## 一、万能代换

### 🔑 万能代换公式

令 $t = \tan \frac{x}{2}$，则：

1. **基本关系**：
   - $\sin x = \frac{2t}{1+t^2}$
   - $\cos x = \frac{1-t^2}{1+t^2}$
   - $\tan x = \frac{2t}{1-t^2}$
   - $dx = \frac{2}{1+t^2}dt$

2. **适用范围**：
   - $x \in (-\pi, \pi)$（保证 $t = \tan \frac{x}{2}$ 有定义）

### 💡 万能代换的优缺点
- **优点**：理论上可以处理所有三角函数有理式
- **缺点**：计算可能变得复杂，有时不是最优方法

### 📐 例题3.37（万能代换）
计算：$\int \frac{1}{2 + \sin x}dx$

**解**：
令 $t = \tan \frac{x}{2}$，则 $\sin x = \frac{2t}{1+t^2}$，$dx = \frac{2}{1+t^2}dt$

$$\begin{aligned}
\int \frac{1}{2 + \sin x}dx &= \int \frac{1}{2 + \frac{2t}{1+t^2}} \cdot \frac{2}{1+t^2}dt \\
&= \int \frac{2}{(1+t^2)(2 + \frac{2t}{1+t^2})}dt \\
&= \int \frac{2}{2(1+t^2) + 2t}dt \\
&= \int \frac{2}{2t^2 + 2t + 2}dt \\
&= \int \frac{1}{t^2 + t + 1}dt
\end{aligned}$$

配方：$t^2 + t + 1 = (t + \frac{1}{2})^2 + \frac{3}{4}$

$$\begin{aligned}
&= \int \frac{1}{(t + \frac{1}{2})^2 + \frac{3}{4}}dt \\
&= \frac{2}{\sqrt{3}}\arctan\frac{2t + 1}{\sqrt{3}} + C \\
&= \frac{2\sqrt{3}}{3}\arctan\frac{2\tan\frac{x}{2} + 1}{\sqrt{3}} + C
\end{aligned}$$

## 二、特殊代换法

### 🔑 三种特殊情况

根据被积函数的奇偶性，可以选择更简单的代换：

1. **$R(-\sin x, \cos x) = -R(\sin x, \cos x)$**：
   - 关于 $\sin x$ 为奇函数
   - 令 $t = \cos x$

2. **$R(\sin x, -\cos x) = -R(\sin x, \cos x)$**：
   - 关于 $\cos x$ 为奇函数
   - 令 $t = \sin x$

3. **$R(-\sin x, -\cos x) = R(\sin x, \cos x)$**：
   - 关于 $\sin x$ 和 $\cos x$ 都为偶函数
   - 令 $t = \tan x$

### 📐 例题3.38（sin x 的奇函数）
计算：$\int \frac{\sin x}{1 + \cos^2 x}dx$

**解**：
注意到被积函数关于 $\sin x$ 为奇函数，令 $t = \cos x$，则 $dt = -\sin x dx$

$$\begin{aligned}
\int \frac{\sin x}{1 + \cos^2 x}dx &= -\int \frac{1}{1 + t^2}dt \\
&= -\arctan t + C \\
&= -\arctan(\cos x) + C
\end{aligned}$$

### 📐 例题3.39（cos x 的奇函数）
计算：$\int \frac{\cos x}{\sin x(1 + \sin x)}dx$

**解**：
关于 $\cos x$ 为奇函数，令 $t = \sin x$，则 $dt = \cos x dx$

$$\begin{aligned}
\int \frac{\cos x}{\sin x(1 + \sin x)}dx &= \int \frac{1}{t(1 + t)}dt \\
&= \int \left(\frac{1}{t} - \frac{1}{1 + t}\right)dt \\
&= \ln|t| - \ln|1 + t| + C \\
&= \ln\left|\frac{\sin x}{1 + \sin x}\right| + C
\end{aligned}$$

### 📐 例题3.40（tan x 代换）
计算：$\int \frac{1}{\sin^2 x + 2\cos^2 x}dx$

**解**：
分子分母同除以 $\cos^2 x$：
$$\int \frac{1}{\sin^2 x + 2\cos^2 x}dx = \int \frac{\sec^2 x}{\tan^2 x + 2}dx$$

令 $t = \tan x$，则 $dt = \sec^2 x dx$

$$\begin{aligned}
&= \int \frac{1}{t^2 + 2}dt \\
&= \frac{1}{\sqrt{2}}\arctan\frac{t}{\sqrt{2}} + C \\
&= \frac{\sqrt{2}}{2}\arctan\frac{\tan x}{\sqrt{2}} + C
\end{aligned}$$

## 三、三角恒等式法

### 🔑 常用恒等式

1. **积化和差**：
   - $\sin A \cos B = \frac{1}{2}[\sin(A+B) + \sin(A-B)]$
   - $\cos A \cos B = \frac{1}{2}[\cos(A+B) + \cos(A-B)]$
   - $\sin A \sin B = -\frac{1}{2}[\cos(A+B) - \cos(A-B)]$

2. **倍角公式**：
   - $\sin^2 x = \frac{1 - \cos 2x}{2}$
   - $\cos^2 x = \frac{1 + \cos 2x}{2}$

3. **半角公式**：
   - $\sin^2 \frac{x}{2} = \frac{1 - \cos x}{2}$
   - $\cos^2 \frac{x}{2} = \frac{1 + \cos x}{2}$

### 📐 例题3.41（利用倍角公式）
计算：$\int \sin^2 x dx$

**解**：
利用 $\sin^2 x = \frac{1 - \cos 2x}{2}$

$$\begin{aligned}
\int \sin^2 x dx &= \int \frac{1 - \cos 2x}{2}dx \\
&= \frac{1}{2}\int (1 - \cos 2x)dx \\
&= \frac{1}{2}\left(x - \frac{\sin 2x}{2}\right) + C \\
&= \frac{x}{2} - \frac{\sin 2x}{4} + C
\end{aligned}$$

### 📐 例题3.42（积化和差）
计算：$\int \sin 3x \cos 5x dx$

**解**：
利用积化和差公式：
$$\sin 3x \cos 5x = \frac{1}{2}[\sin 8x + \sin(-2x)] = \frac{1}{2}(\sin 8x - \sin 2x)$$

因此：
$$\begin{aligned}
\int \sin 3x \cos 5x dx &= \frac{1}{2}\int (\sin 8x - \sin 2x)dx \\
&= \frac{1}{2}\left(-\frac{\cos 8x}{8} + \frac{\cos 2x}{2}\right) + C \\
&= -\frac{\cos 8x}{16} + \frac{\cos 2x}{4} + C
\end{aligned}$$

## 四、分部积分法处理

### 📐 例题3.43
计算：$\int \sec^3 x dx$

**解**：
$$\int \sec^3 x dx = \int \sec x \cdot \sec^2 x dx$$

令 $u = \sec x$，$dv = \sec^2 x dx$
则 $du = \sec x \tan x dx$，$v = \tan x$

$$\begin{aligned}
\int \sec^3 x dx &= \sec x \tan x - \int \tan x \cdot \sec x \tan x dx \\
&= \sec x \tan x - \int \sec x \tan^2 x dx \\
&= \sec x \tan x - \int \sec x (\sec^2 x - 1)dx \\
&= \sec x \tan x - \int \sec^3 x dx + \int \sec x dx
\end{aligned}$$

移项得：
$$2\int \sec^3 x dx = \sec x \tan x + \ln|\sec x + \tan x| + C$$

所以：
$$\int \sec^3 x dx = \frac{1}{2}(\sec x \tan x + \ln|\sec x + \tan x|) + C$$

## 🎯 易错提醒

1. **代换范围**：万能代换要注意定义域限制
2. **恒等式应用**：要熟记三角恒等式，选择合适的变形
3. **特殊代换条件**：判断奇偶性时要仔细
4. **积分常数**：每个不定积分都要加常数 $C$
5. **回代错误**：代换后要正确回代原变量

## 🔗 相关链接
- [[三角函数积分]]
- [[有理函数积分]]
- [[第二类换元积分法]]
- [[三角恒等变换]]

## 🔗 相关题目练习
根据标签可在题库中搜索：
- 知识点标签：`三角函数有理式积分` `万能代换`
- 章节标签：`一元函数积分学`
- 难度：`hard`

---
*创建时间：2025-07-30*